var El=Object.defineProperty;var so=t=>{throw TypeError(t)};var Tl=(t,e,r)=>e in t?El(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var b=(t,e,r)=>Tl(t,typeof e!="symbol"?e+"":e,r),xi=(t,e,r)=>e.has(t)||so("Cannot "+r);var l=(t,e,r)=>(xi(t,e,"read from private field"),r?r.call(t):e.get(t)),d=(t,e,r)=>e.has(t)?so("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),f=(t,e,r,n)=>(xi(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),N=(t,e,r)=>(xi(t,e,"access private method"),r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var Pr,kr,xr,Vt,$o;let G=($o=class{constructor(){d(this,Pr);d(this,kr);d(this,xr);d(this,Vt,"running");b(this,"resolve",e=>{l(this,kr).call(this,e),f(this,Vt,"resolved")});b(this,"reject",e=>{l(this,xr).call(this,e),f(this,Vt,"rejected")});f(this,Pr,new Promise((e,r)=>{f(this,kr,e),f(this,xr,r)}))}get promise(){return l(this,Pr)}get state(){return l(this,Vt)}},Pr=new WeakMap,kr=new WeakMap,xr=new WeakMap,Vt=new WeakMap,$o);class Rl{constructor(e=0){b(this,"nextId");b(this,"pendingResolvers",new Map);this.nextId=e}add(){const e=this.nextId++,r=new G;return this.pendingResolvers.set(e,r),[e,r.promise]}getResolver(e){if(!this.pendingResolvers.has(e))return null;const r=this.pendingResolvers.get(e);return this.pendingResolvers.delete(e),r}resolve(e,r){const n=this.getResolver(e);return n!==null?(n.resolve(r),!0):!1}reject(e,r){const n=this.getResolver(e);return n!==null?(n.reject(r),!0):!1}}function Pl(t){return new Promise(e=>{globalThis.setTimeout(()=>e(),t)})}function Es(t){return typeof t=="object"&&t!==null&&"then"in t}function Gi(t,e){for(;;){const{done:r,value:n}=t.next(e);if(r)return n;if(Es(n))return n.then(i=>Gi(t,{resolved:i}),i=>Gi(t,{error:i}));e=n}}function Ts(t,e){function r(...n){const i=t.call(this,function*(s){if(Es(s)){const o=yield s;if("resolved"in o)return o.resolved;throw o.error}return s},...n);return Gi(i,void 0)}return r}function kl(t){return(e,r)=>{if("buffer"in r){const n=t(e,r);return r.buffer.set(n,r.index),n.length}else return t(e,r)}}function xl(t,e){return(r,n)=>{if("buffer"in n)return n.index??(n.index=0),e(r,n),t;{const i=new Uint8Array(t);return e(r,{buffer:i,index:0,littleEndian:n.littleEndian}),i}}}function zl(t,e,r,n,i){const s={size:t,type:e,serialize:e==="default"?kl(r):xl(t,r),deserialize:Ts(n),omitInit:i?.omitInit};return i?.init&&(s.init=i.init),s}const ur=zl,Y=new Uint8Array(0);function Cl(t,e,r,n){e.length<n?(t.set(e,r),t.fill(0,r+e.length,r+n)):e.length===n?t.set(e,r):t.set(e.subarray(0,n),r)}function _n(t,e){if(typeof t=="number"){let i,s,o;return t===0?(i=()=>{},e?s=function*(){return e.convert(Y)}:s=function*(){return Y}):(i=(a,{buffer:c,index:u})=>Cl(c,a,u,t),e?(s=function*(a,c){const u=c.readExactly(t);return e.convert(yield*a(u))},o=a=>e.back(a)):s=function*(a,c){return c.readExactly(t)}),ur(t,"byob",i,s,{init:o})}if((typeof t=="object"||typeof t=="function")&&"serialize"in t){let i,s;return e?(i=function*(o,a,c){const u=yield*o(t.deserialize(a,c)),h=u!==0?a.readExactly(u):Y;return e.convert(yield*o(h))},s=o=>e.back(o)):i=function*(o,a,c){const u=yield*o(t.deserialize(a,c));return u!==0?a.readExactly(u):Y},ur(t.size,"default",(o,{littleEndian:a})=>{if(t.type==="default"){const c=t.serialize(o.length,{littleEndian:a});if(o.length===0)return c;const u=new Uint8Array(c.length+o.length);return u.set(c,0),u.set(o,c.length),u}else{const c=new Uint8Array(t.size+o.length);return t.serialize(o.length,{buffer:c,index:0,littleEndian:a}),c.set(o,t.size),c}},i,{init:s})}if(typeof t=="string"){let i,s;return e?(i=function*(o,a,{dependencies:c}){const u=c[t],h=u!==0?a.readExactly(u):Y;return e.convert(yield*o(h))},s=(o,a)=>{const c=e.back(o);return a[t]=c.length,c}):(i=function*(o,a,{dependencies:c}){const u=c[t];return u!==0?a.readExactly(u):Y},s=(o,a)=>{const c=o;return a[t]=c.length,c}),ur(0,"default",o=>o,i,{init:s})}let r,n;return e?(r=function*(i,s,{dependencies:o}){const a=o[t.field],c=t.convert(a),u=c!==0?s.readExactly(c):Y;return e.convert(yield*i(u))},n=(i,s)=>{const o=e.back(i);return s[t.field]=t.back(o.length),o}):(r=function*(i,s,{dependencies:o}){const a=o[t.field],c=t.convert(a);return c!==0?s.readExactly(c):Y},n=(i,s)=>{const o=i;return s[t.field]=t.back(o.length),o}),ur(0,"default",i=>i,r,{init:n})}class Rs extends Error{constructor(){super("ExactReadable ended")}}class Uo extends Error{constructor(e){super(e)}}class Il extends Uo{constructor(){super("The underlying readable was ended before the struct was fully deserialized")}}class Ps extends Uo{constructor(){super("The underlying readable doesn't contain any more struct")}}function J(t,e){const r=Object.entries(t);let n=0,i=!0;for(const[,a]of r)n+=a.size,i&&a.type!=="byob"&&(i=!1);const s=e.littleEndian,o=e.extra?Object.getOwnPropertyDescriptors(e.extra):void 0;return{littleEndian:s,fields:t,extra:e.extra,type:i?"byob":"default",size:n,serialize(a,c){const u={...a};for(const[C,w]of r)if(C in u&&"init"in w){const R=w.init?.(u[C],u);u[C]=R}const h=new Array(r.length),m=new Array(r.length);{const C={littleEndian:s};for(const[w,[R,D]]of r.entries())D.type==="byob"?h[w]=D.size:(m[w]=D.serialize(u[R],C),h[w]=m[w].length)}const p=h.reduce((C,w)=>C+w,0);let g,T,I;if(c instanceof Uint8Array){if(c.length<p)throw new Error("Buffer too small");g=!0,T=c,I=0}else if(typeof c=="object"&&"buffer"in c){if(g=!0,T=c.buffer,I=c.index??0,T.length-I<p)throw new Error("Buffer too small")}else g=!1,T=new Uint8Array(p),I=0;const q={buffer:T,index:I,littleEndian:s};for(const[C,[w,R]]of r.entries())m[C]?T.set(m[C],q.index):R.serialize(u[w],q),q.index+=h[C];return g?p:T},deserialize:Ts(function*(a,c){const u=c.position,h={},m={dependencies:h,littleEndian:s};try{for(const[p,g]of r)h[p]=yield*a(g.deserialize(c,m))}catch(p){throw p instanceof Rs?c.position===u?new Ps:new Il:p}return o&&Object.defineProperties(h,o),e.postDeserialize?e.postDeserialize.call(h,h):h})}}function ks(t,e,r){return J(Object.assign({},t.fields,e),{littleEndian:r?.littleEndian??t.littleEndian,extra:t.extra,postDeserialize:r?.postDeserialize})}function Al(t,e,r){t[e]=Number(r&0xffn),t[e+1]=Number(r>>8n&0xffn),t[e+2]=Number(r>>16n&0xffn),t[e+3]=Number(r>>24n&0xffn),t[e+4]=Number(r>>32n&0xffn),t[e+5]=Number(r>>40n&0xffn),t[e+6]=Number(r>>48n&0xffn),t[e+7]=Number(r>>56n&0xffn)}function Ll(t,e,r){t[e]=Number(r>>56n&0xffn),t[e+1]=Number(r>>48n&0xffn),t[e+2]=Number(r>>40n&0xffn),t[e+3]=Number(r>>32n&0xffn),t[e+4]=Number(r>>24n&0xffn),t[e+5]=Number(r>>16n&0xffn),t[e+6]=Number(r>>8n&0xffn),t[e+7]=Number(r&0xffn)}function wi(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Bl(t,e,r){return r?(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0:(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}function ql(t,e,r){t[e]=r,t[e+1]=r>>8,t[e+2]=r>>16,t[e+3]=r>>24}function Ol(t,e,r,n){n?(t[e]=r,t[e+1]=r>>8,t[e+2]=r>>16,t[e+3]=r>>24):(t[e]=r>>24,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r)}function Dl(t,e){return BigInt(t[e])<<56n|BigInt(t[e+1])<<48n|BigInt(t[e+2])<<40n|BigInt(t[e+3])<<32n|BigInt(t[e+4])<<24n|BigInt(t[e+5])<<16n|BigInt(t[e+6])<<8n|BigInt(t[e+7])}function Wl(t,e,r){return r?BigInt(t[e])|BigInt(t[e+1])<<8n|BigInt(t[e+2])<<16n|BigInt(t[e+3])<<24n|BigInt(t[e+4])<<32n|BigInt(t[e+5])<<40n|BigInt(t[e+6])<<48n|BigInt(t[e+7])<<56n:BigInt(t[e])<<56n|BigInt(t[e+1])<<48n|BigInt(t[e+2])<<40n|BigInt(t[e+3])<<32n|BigInt(t[e+4])<<24n|BigInt(t[e+5])<<16n|BigInt(t[e+6])<<8n|BigInt(t[e+7])}function Nl(t,e,r,n){n?(t[e]=Number(r&0xffn),t[e+1]=Number(r>>8n&0xffn),t[e+2]=Number(r>>16n&0xffn),t[e+3]=Number(r>>24n&0xffn),t[e+4]=Number(r>>32n&0xffn),t[e+5]=Number(r>>40n&0xffn),t[e+6]=Number(r>>48n&0xffn),t[e+7]=Number(r>>56n&0xffn)):(t[e]=Number(r>>56n&0xffn),t[e+1]=Number(r>>48n&0xffn),t[e+2]=Number(r>>40n&0xffn),t[e+3]=Number(r>>32n&0xffn),t[e+4]=Number(r>>24n&0xffn),t[e+5]=Number(r>>16n&0xffn),t[e+6]=Number(r>>8n&0xffn),t[e+7]=Number(r&0xffn))}function xs(t,e,r){const n=()=>n;return Object.assign(n,ur(t,"byob",e,r)),n}const jl=xs(1,(t,{buffer:e,index:r})=>{e[r]=t},function*(t,e){return(yield*t(e.readExactly(1)))[0]}),_=xs(4,(t,{buffer:e,index:r,littleEndian:n})=>{Ol(e,r,t,n)},function*(t,e,{littleEndian:r}){const n=yield*t(e.readExactly(4));return Bl(n,0,r)}),It=xs(8,(t,{buffer:e,index:r,littleEndian:n})=>{Nl(e,r,t,n)},function*(t,e,{littleEndian:r}){const n=yield*t(e.readExactly(8));return Wl(n,0,r)}),{TextEncoder:$l,TextDecoder:Ul}=globalThis,Fl=new $l,Ml=new Ul;function xt(t){return Fl.encode(t)}function vn(t){return Ml.decode(t)}const wr=t=>{const e=_n(t,{convert:vn,back:xt});return e.as=()=>e,e},{AbortController:yi}=globalThis,zt=(()=>{const{ReadableStream:t}=globalThis;return t.from||(t.from=function(e){const r=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return new t({async pull(n){const i=await r.next();if(i.done){n.close();return}n.enqueue(i.value)},async cancel(n){await r.return?.(n)}})}),(!t.prototype[Symbol.asyncIterator]||!t.prototype.values)&&(t.prototype.values=async function*(e){const r=this.getReader();try{for(;;){const{done:n,value:i}=await r.read();if(n)return;yield i}}finally{e?.preventCancel||await r.cancel(),r.releaseLock()}},t.prototype[Symbol.asyncIterator]=t.prototype.values),t})(),{WritableStream:_e,TransformStream:Vl}=globalThis;class sr extends zt{constructor(e,r,n){let i,s=!1;const o=new yi;super({start:a=>{const c=e({abortSignal:o.signal,enqueue:async u=>{if(n?.({source:"producer",operation:"enqueue",value:u,phase:"start"}),o.signal.aborted){n?.({source:"producer",operation:"enqueue",value:u,phase:"ignored"});return}if(a.desiredSize===null){a.enqueue(u);return}if(s){s=!1,a.enqueue(u),n?.({source:"producer",operation:"enqueue",value:u,phase:"complete"});return}if(a.desiredSize<=0&&(n?.({source:"producer",operation:"enqueue",value:u,phase:"waiting"}),i=new G,await i.promise,o.signal.aborted)){n?.({source:"producer",operation:"enqueue",value:u,phase:"ignored"});return}a.enqueue(u),n?.({source:"producer",operation:"enqueue",value:u,phase:"complete"})},close(){if(n?.({source:"producer",operation:"close",explicit:!0,phase:"start"}),o.signal.aborted){n?.({source:"producer",operation:"close",explicit:!0,phase:"ignored"});return}a.close(),n?.({source:"producer",operation:"close",explicit:!0,phase:"complete"})},error(u){n?.({source:"producer",operation:"error",explicit:!0,phase:"start"}),a.error(u),n?.({source:"producer",operation:"error",explicit:!0,phase:"complete"})}});c&&"then"in c&&c.then(()=>{n?.({source:"producer",operation:"close",explicit:!1,phase:"start"});try{a.close(),n?.({source:"producer",operation:"close",explicit:!1,phase:"complete"})}catch{n?.({source:"producer",operation:"close",explicit:!1,phase:"ignored"})}},u=>{n?.({source:"producer",operation:"error",explicit:!1,phase:"start"}),a.error(u),n?.({source:"producer",operation:"error",explicit:!1,phase:"complete"})})},pull:()=>{n?.({source:"consumer",operation:"pull",phase:"start"}),i?i.resolve():r?.highWaterMark===0&&(s=!0),n?.({source:"consumer",operation:"pull",phase:"complete"})},cancel:a=>{n?.({source:"consumer",operation:"cancel",phase:"start"}),o.abort(a),i?.resolve(),n?.({source:"consumer",operation:"cancel",phase:"complete"})}},r)}}async function Kl(t){try{return await t.cancel(),!0}catch{return!1}}var Se,Ee,Te,je,Ge,Xi,Zi;class gi{constructor(e){d(this,Ge);d(this,Se);d(this,Ee,0);d(this,Te,0);d(this,je,0);b(this,"stream");b(this,"reader");b(this,"readExactly",Ts(function*(e,r){let n,i=0;const s=N(this,Ge,Xi).call(this,r);if(s){if(s.length===r)return s;n=new Uint8Array(r),n.set(s,i),i+=s.length,r-=s.length}else n=new Uint8Array(r);for(;r>0;){const o=yield*e(N(this,Ge,Zi).call(this,r));n.set(o,i),i+=o.length,r-=o.length}return n}));this.stream=e,this.reader=e.getReader()}get position(){return l(this,je)}iterateExactly(e){let r=l(this,Se)?0:1;return{next:()=>{switch(r){case 0:{const n=N(this,Ge,Xi).call(this,e);return n.length===e?r=2:(e-=n.length,r=1),{done:!1,value:n}}case 1:return r=3,{done:!1,value:N(this,Ge,Zi).call(this,e).then(n=>(n.length===e?r=2:(e-=n.length,r=1),n))};case 2:return{done:!0,value:void 0};case 3:throw new Error("Can't call `next` before previous Promise resolves");default:throw new Error("unreachable")}}}}release(){return l(this,Te)>0?new sr(async e=>{const r=l(this,Se).subarray(l(this,Ee));for(await e.enqueue(r),e.abortSignal.addEventListener("abort",()=>{Kl(this.reader)});;){const{done:n,value:i}=await this.reader.read();if(n)return;await e.enqueue(i)}}):(this.reader.releaseLock(),this.stream)}async cancel(e){await this.reader.cancel(e)}}Se=new WeakMap,Ee=new WeakMap,Te=new WeakMap,je=new WeakMap,Ge=new WeakSet,Xi=function(e){if(!l(this,Se))return;const r=l(this,Se).subarray(l(this,Ee),l(this,Ee)+e);return l(this,Te)>e?(f(this,je,l(this,je)+e),f(this,Ee,l(this,Ee)+e),f(this,Te,l(this,Te)-e),r):(f(this,je,l(this,je)+l(this,Te)),f(this,Se,void 0),f(this,Ee,0),f(this,Te,0),r)},Zi=async function(e){const{done:r,value:n}=await this.reader.read();if(r)throw new Rs;return n.length>e?(f(this,Se,n),f(this,Ee,e),f(this,Te,n.length-e),f(this,je,l(this,je)+e),n.subarray(0,e)):(f(this,je,l(this,je)+n.length),n)};var zr,Cr;class Yl{constructor(e){d(this,zr);d(this,Cr);let r,n;const i=new gi(new sr(s=>{r=s}));f(this,zr,new zt({async pull(s){try{const o=await e(i);s.enqueue(o)}catch(o){if(o instanceof Ps){s.close();return}throw o}},cancel:s=>n.error(s)})),f(this,Cr,new _e({start(s){n=s},async write(s){await r.enqueue(s)},abort(){r.close()},close(){r.close()}}))}get readable(){return l(this,zr)}get writable(){return l(this,Cr)}}zr=new WeakMap,Cr=new WeakMap;var Kt,ae,ci,ot,Ir;class Kn{constructor(){d(this,Kt,"");d(this,ae,new G);d(this,ci,new _e({write:e=>{f(this,Kt,l(this,Kt)+e)},close:()=>{l(this,ae).resolve(l(this,Kt)),l(this,ot).enqueue(l(this,Kt)),l(this,ot).close()},abort:e=>{l(this,ae).reject(e),l(this,ot).error(e)}}));d(this,ot);d(this,Ir,new zt({start:e=>{f(this,ot,e)}}));Object.defineProperties(l(this,Ir),{then:{get:()=>l(this,ae).promise.then.bind(l(this,ae).promise)},catch:{get:()=>l(this,ae).promise.catch.bind(l(this,ae).promise)},finally:{get:()=>l(this,ae).promise.finally.bind(l(this,ae).promise)}})}get writable(){return l(this,ci)}get readable(){return l(this,Ir)}}Kt=new WeakMap,ae=new WeakMap,ci=new WeakMap,ot=new WeakMap,Ir=new WeakMap;var $e,le,ui,at,Ar;class Qi{constructor(){d(this,$e,[]);d(this,le,new G);d(this,ui,new _e({write:e=>{l(this,$e).push(e)},close:()=>{let e,r=0;switch(l(this,$e).length){case 0:e=Y;break;case 1:e=l(this,$e)[0];break;default:e=new Uint8Array(l(this,$e).reduce((n,i)=>n+i.length,0));for(const n of l(this,$e))e.set(n,r),r+=n.length;break}l(this,le).resolve(e),l(this,at).enqueue(e),l(this,at).close()},abort:e=>{l(this,le).reject(e),l(this,at).error(e)}}));d(this,at);d(this,Ar,new zt({start:e=>{f(this,at,e)}}));Object.defineProperties(l(this,Ar),{then:{get:()=>l(this,le).promise.then.bind(l(this,le).promise)},catch:{get:()=>l(this,le).promise.catch.bind(l(this,le).promise)},finally:{get:()=>l(this,le).promise.finally.bind(l(this,le).promise)}})}get writable(){return l(this,ui)}get readable(){return l(this,Ar)}}$e=new WeakMap,le=new WeakMap,ui=new WeakMap,at=new WeakMap,Ar=new WeakMap;class _i extends zt{static async enqueue(e,r){const n=new ye(r);e.enqueue(n),await n.consumed}constructor(e,r){let n,i;r&&(i={},"highWaterMark"in r&&(i.highWaterMark=r.highWaterMark),"size"in r&&(i.size=s=>r.size(s.value))),super({start(s){return n={enqueue(o){return _i.enqueue(s,o)},close(){s.close()},error(o){s.error(o)}},e.start?.(n)},pull(){return e.pull?.(n)},cancel(s){return e.cancel?.(s)}},i)}}class Hl extends zt{constructor(e,r,n){const i=e.getReader({mode:"byob"});let s=new Uint8Array(r);super({async pull(o){const{done:a,value:c}=await i.read(s,{min:n});if(a){o.close();return}await _i.enqueue(o,c),s=new Uint8Array(c.buffer)},cancel(o){return i.cancel(o)}})}}class Gl extends _e{constructor(e){const r=e.getWriter();super({write(n){return n.tryConsume(i=>r.write(i))},abort(n){return r.abort(n)},close(){return r.close()}})}}let Xl=class extends _e{static async write(e,r){const n=new ye(r);await e.write(n),await n.consumed}constructor(e,r){let n;r&&(n={},"highWaterMark"in r&&(n.highWaterMark=r.highWaterMark),"size"in r&&(n.size=i=>r.size(i instanceof ye?i.value:i))),super({start(i){return e.start?.(i)},write(i,s){return i.tryConsume(o=>e.write?.(o,s))},abort(i){return e.abort?.(i)},close(){return e.close?.()}},n)}};const{console:oo}=globalThis,Zl=oo?.createTask?.bind(oo)??(()=>({run(t){return t()}}));var Bt,Lr,ce;let ye=(Bt=class{constructor(e){d(this,Lr);d(this,ce);b(this,"value");b(this,"consumed");f(this,Lr,Zl("Consumable")),this.value=e,f(this,ce,new G),this.consumed=l(this,ce).promise}consume(){l(this,ce).resolve()}error(e){l(this,ce).reject(e)}tryConsume(e){try{let r=l(this,Lr).run(()=>e(this.value));return Es(r)?r=r.then(n=>(l(this,ce).resolve(),n),n=>{throw l(this,ce).reject(n),n}):l(this,ce).resolve(),r}catch(r){throw l(this,ce).reject(r),r}}},Lr=new WeakMap,ce=new WeakMap,b(Bt,"WritableStream",Xl),b(Bt,"WrapWritableStream",Gl),b(Bt,"ReadableStream",_i),b(Bt,"WrapByteReadableStream",Hl),Bt);function Fo(t,e){return t instanceof ye?t.tryConsume(e):e(t)}class Sn extends _e{constructor(e,r){let n;r&&(n={},"highWaterMark"in r&&(n.highWaterMark=r.highWaterMark),"size"in r&&(n.size=i=>r.size(i instanceof ye?i.value:i))),super({start(i){return e.start?.(i)},write(i,s){return Fo(i,o=>e.write?.(o,s))},abort(i){return e.abort?.(i)},close(){return e.close?.()}},n)}}var Re,Pe,Z,ee;class Mo{constructor(e){d(this,Re);d(this,Pe);d(this,Z);d(this,ee);f(this,Re,e),f(this,Pe,new Uint8Array(e)),f(this,Z,0),f(this,ee,e)}*push(e){let r=0,n=e.length;if(l(this,Z)!==0)if(n>=l(this,ee)){if(l(this,Pe).set(e.subarray(0,l(this,ee)),l(this,Z)),r+=l(this,ee),n-=l(this,ee),yield l(this,Pe),f(this,Z,0),f(this,ee,l(this,Re)),n===0)return}else{l(this,Pe).set(e,l(this,Z)),f(this,Z,l(this,Z)+n),f(this,ee,l(this,ee)-n);return}for(;n>=l(this,Re);){const i=r+l(this,Re);yield e.subarray(r,i),r=i,n-=l(this,Re)}n>0&&(l(this,Pe).set(e.subarray(r),l(this,Z)),f(this,Z,l(this,Z)+n),f(this,ee,l(this,ee)-n))}flush(){if(l(this,Z)===0)return;const e=l(this,Pe).subarray(0,l(this,Z));return f(this,Z,0),f(this,ee,l(this,Re)),e}}Re=new WeakMap,Pe=new WeakMap,Z=new WeakMap,ee=new WeakMap;class Ql extends Vl{constructor(e,r=!1){const n=r?new Mo(e):void 0;super({async transform(i,s){await Fo(i,async o=>{if(n)for(const a of n.push(o))await ye.ReadableStream.enqueue(s,a);else{let a=0,c=o.length;for(;c>0;){const u=a+e;await ye.ReadableStream.enqueue(s,o.subarray(a,u)),a=u,c-=e}}})},flush(i){if(n){const s=n.flush();s&&i.enqueue(s)}}})}}const Jl=globalThis,Yn=Jl.TextDecoderStream;class Vo extends Yl{constructor(e){super(r=>e.deserialize(r))}}var Yt;class ec{constructor(){d(this,Yt,[]);this.dispose=this.dispose.bind(this)}addDisposable(e){return l(this,Yt).push(e),e}dispose(){for(const e of l(this,Yt))e.dispose();f(this,Yt,[])}}Yt=new WeakMap;var Br;class zs extends ec{constructor(r){super();d(this,Br);f(this,Br,r)}get adb(){return l(this,Br)}}Br=new WeakMap;const tc=J({version:_},{littleEndian:!0}),rc=J({bpp:_,size:_,width:_,height:_,red_offset:_,red_length:_,blue_offset:_,blue_length:_,green_offset:_,green_length:_,alpha_offset:_,alpha_length:_,data:_n("size")},{littleEndian:!0}),nc=J({bpp:_,colorSpace:_,size:_,width:_,height:_,red_offset:_,red_length:_,blue_offset:_,blue_length:_,green_offset:_,green_length:_,alpha_offset:_,alpha_length:_,data:_n("size")},{littleEndian:!0});class Ko extends Error{constructor(e,r){super(e,r)}}class ic extends Ko{constructor(e){super(`Unsupported FrameBuffer version ${e}`)}}class sc extends Ko{constructor(){super("FrameBuffer is disabled by current app")}}async function oc(t){const e=await t.createSocket("framebuffer:"),r=new gi(e.readable);let n;try{({version:n}=await tc.deserialize(r))}catch(i){throw i instanceof Ps?new sc:i}switch(n){case 1:return await rc.deserialize(r);case 2:return await nc.deserialize(r);default:throw new ic(n)}}class ac extends zs{reboot(e=""){return this.adb.createSocketAndWait(`reboot:${e}`)}bootloader(){return this.reboot("bootloader")}fastboot(){return this.reboot("fastboot")}recovery(){return this.reboot("recovery")}sideload(){return this.reboot("sideload")}qualcommEdlMode(){return this.reboot("edl")}powerOff(){return this.adb.subprocess.noneProtocol.spawnWaitText(["reboot","-p"])}powerButton(e=!1){const r=["input","keyevent"];return e&&r.push("--longpress"),r.push("POWER"),this.adb.subprocess.noneProtocol.spawnWaitText(r)}samsungOdin(){return this.reboot("download")}}var lt,ke;class Yo{constructor(e=!1){d(this,lt);d(this,ke,[]);f(this,lt,e)}wait(){if(!l(this,lt)&&(f(this,lt,!0),l(this,ke).length===0))return Promise.resolve();const e=new G;return l(this,ke).push(e),e.promise}notifyOne(){l(this,ke).length!==0?l(this,ke).pop().resolve():f(this,lt,!1)}dispose(){for(const e of l(this,ke))e.reject(new Error("The AutoResetEvent has been disposed"));l(this,ke).length=0}}lt=new WeakMap,ke=new WeakMap;const[Vd,U,jt]=(()=>{const t=[],e=[];function n(i,s){const o=i.charCodeAt(0),a=s.charCodeAt(0);for(let c=o;c<=a;c+=1)t[c]=e.length,e.push(c)}return n("A","Z"),n("a","z"),n("0","9"),n("+","+"),n("/","/"),[t,e,61]})();function Ho(t){const e=t%3,r=e!==0?3-e:0;return[(t+r)/3*4,r]}function lc(t,e){const[r,n]=Ho(t.length);if(e){if(e.length<r)throw new TypeError("output buffer is too small");if(e=e.subarray(0,r),t.buffer!==e.buffer)zi(t,e,n);else if(e.byteOffset+e.length-(n+1)<=t.byteOffset+t.length)zi(t,e,n);else if(e.byteOffset>=t.byteOffset-1)cc(t,e,n);else throw new TypeError("input and output cannot overlap");return r}else return e=new Uint8Array(r),zi(t,e,n),e}function zi(t,e,r){let n=0,i=0;for(;n<t.length-2;){const s=t[n];n+=1;const o=t[n];n+=1;const a=t[n];n+=1,e[i]=U[s>>2],i+=1,e[i]=U[(s&3)<<4|o>>4],i+=1,e[i]=U[(o&15)<<2|a>>6],i+=1,e[i]=U[a&63],i+=1}if(r===2){const s=t[n];n+=1,e[i]=U[s>>2],i+=1,e[i]=U[(s&3)<<4],i+=1,e[i]=jt,i+=1,e[i]=jt}else if(r===1){const s=t[n];n+=1;const o=t[n];n+=1,e[i]=U[s>>2],i+=1,e[i]=U[(s&3)<<4|o>>4],i+=1,e[i]=U[(o&15)<<2],i+=1,e[i]=jt}}function cc(t,e,r){let n=t.length-1,i=e.length-1;if(r===2){const s=t[n];n-=1,e[i]=jt,i-=1,e[i]=jt,i-=1,e[i]=U[(s&3)<<4],i-=1,e[i]=U[s>>2],i-=1}else if(r===1){const s=t[n];n-=1;const o=t[n];n-=1,e[i]=jt,i-=1,e[i]=U[(s&15)<<2],i-=1,e[i]=U[(o&3)<<4|s>>4],i-=1,e[i]=U[o>>2],i-=1}for(;n>=0;){const s=t[n];n-=1;const o=t[n];n-=1;const a=t[n];n-=1,e[i]=U[s&63],i-=1,e[i]=U[(o&15)<<2|s>>6],i-=1,e[i]=U[(a&3)<<4|o>>4],i-=1,e[i]=U[a>>2],i-=1}}function uc(t){if(t<48)throw new TypeError(`Invalid hex char ${t}`);if(t<58)return t-48;if(t<65)throw new TypeError(`Invalid hex char ${t}`);if(t<71)return t-55;if(t<97)throw new TypeError(`Invalid hex char ${t}`);if(t<103)return t-87;throw new TypeError(`Invalid hex char ${t}`)}function dc(t){let e=0;for(let r=0;r<t.length;r+=1)e=e<<4|uc(t[r]);return e}const hc=()=>{};function fc(...t){throw new Error(`Unreachable. Arguments:
`+t.join(`
`))}function pc(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r+=1)if(t[r]!==e[r])return!1;return!0}const Go=J({length:wr(4),content:wr({field:"length",convert(t){return Number.parseInt(t,16)},back(t){return t.toString(16).padStart(4,"0")}})},{littleEndian:!0});let Xo=class extends Error{constructor(e){super(e)}},bc=class extends Xo{constructor(){super("ADB reverse tunnel is not supported on this device when connected wirelessly.")}};const mc=ks(Go,{},{postDeserialize(t){throw t.content==="more than one device/emulator"?new bc:new Xo(t.content)}});function wc(t){let e=0;for(const r of t){if(r<48||r>57)return e;e=e*10+r-48}return e}const yc=xt("OKAY");var Ht;class gc extends zs{constructor(){super(...arguments);d(this,Ht,new Map)}async createBufferedStream(r){const n=await this.adb.createSocket(r);return new gi(n.readable)}async sendRequest(r){const n=await this.createBufferedStream(r),i=await n.readExactly(4);return pc(i,yc)||await mc.deserialize(n),n}async list(){const r=await this.createBufferedStream("reverse:list-forward");return(await Go.deserialize(r)).content.split(`
`).filter(i=>!!i).map(i=>{const[s,o,a]=i.split(" ");return{deviceSerial:s,localName:o,remoteName:a}})}async addExternal(r,n){const i=await this.sendRequest(`reverse:forward:${r};${n}`);if(r.startsWith("tcp:")){const s=i.position;try{const o=dc(await i.readExactly(4));r=`tcp:${wc(await i.readExactly(o))}`}catch(o){if(!(o instanceof Rs&&i.position===s))throw o}}return r}async add(r,n,i){i=await this.adb.transport.addReverseTunnel(n,i);try{return r=await this.addExternal(r,i),l(this,Ht).set(r,i),r}catch(s){throw await this.adb.transport.removeReverseTunnel(i),s}}async remove(r){const n=l(this,Ht).get(r);n&&await this.adb.transport.removeReverseTunnel(n),await this.sendRequest(`reverse:killforward:${r}`)}async removeAll(){await this.adb.transport.clearReverseTunnels(),l(this,Ht).clear(),await this.sendRequest("reverse:killforward-all")}}Ht=new WeakMap;var be,Gt;class _c{constructor(e,r){d(this,be);d(this,Gt);if(f(this,be,e),r){const n=new G;l(this,be).closed.then(()=>n.resolve(void 0),i=>n.reject(i)),r.addEventListener("abort",()=>{n.reject(r.reason),l(this,be).close()}),f(this,Gt,n.promise)}else f(this,Gt,l(this,be).closed)}get stdin(){return l(this,be).writable}get output(){return l(this,be).readable}get exited(){return l(this,Gt)}kill(){return l(this,be).close()}}be=new WeakMap,Gt=new WeakMap;var Ue,Xt,qr;class vc{constructor(e){d(this,Ue);d(this,Xt);d(this,qr);f(this,Ue,e),f(this,Xt,l(this,Ue).writable.getWriter()),f(this,qr,new Sn({write:r=>l(this,Xt).write(r)}))}get input(){return l(this,qr)}get output(){return l(this,Ue).readable}get exited(){return l(this,Ue).closed}sigint(){return l(this,Xt).write(new Uint8Array([3]))}kill(){return l(this,Ue).close()}}Ue=new WeakMap,Xt=new WeakMap,qr=new WeakMap;function Ji(t){let e="";e+="'";let r=0;for(;;){const n=t.indexOf("'",r);if(n===-1){e+=t.substring(r);break}e+=t.substring(r,n),e+=String.raw`'\''`,r=n+1}return e+="'",e}function Zo(t){const e=[];let r,n=!1,i=0;for(let s=0,o=t.length;s<o;s+=1){if(n){n=!1;continue}const a=t.charAt(s);switch(a){case" ":!r&&s!==i&&(e.push(t.substring(i,s)),i=s+1);break;case"'":case'"':r?a===r&&(r=void 0):r=a;break;case"\\":n=!0;break}}return i<t.length&&e.push(t.substring(i)),e}var Or;class Sc{constructor(e){d(this,Or);f(this,Or,e)}spawn(e,r){return r?.throwIfAborted(),typeof e=="string"&&(e=Zo(e)),l(this,Or).call(this,e,r)}async spawnWait(e){return await(await this.spawn(e)).output.pipeThrough(new Qi)}async spawnWaitText(e){return await(await this.spawn(e)).output.pipeThrough(new Yn).pipeThrough(new Kn)}}Or=new WeakMap;var ct;class Ec extends Sc{constructor(r){super(async(n,i)=>{const s=await l(this,ct).createSocket(`exec:${n.join(" ")}`);if(i?.aborted)throw await s.close(),i.reason;return new _c(s,i)});d(this,ct);f(this,ct,r)}get adb(){return l(this,ct)}async pty(r){return r===void 0?r="":Array.isArray(r)&&(r=r.join(" ")),new vc(await l(this,ct).createSocket(`shell:${r}`))}}ct=new WeakMap;const j={ShellV2:"shell_v2",Cmd:"cmd",StatV2:"stat_v2",ListV2:"ls_v2",FixedPushMkdir:"fixed_push_mkdir",Abb:"abb",AbbExec:"abb_exec",SendReceiveV2:"sendrecv_v2",DelayedAck:"delayed_ack"},ze={Stdin:0,Stdout:1,Stderr:2,Exit:3,CloseStdin:4,WindowSizeChange:5},$t=J({id:jl(),data:_n(_)},{littleEndian:!0});var ut,Zt,Dr,Wr,Nr,jr;class Tc{constructor(e,r){d(this,ut);d(this,Zt);d(this,Dr);d(this,Wr);d(this,Nr);d(this,jr);f(this,ut,e);let n,i;f(this,Wr,new sr(o=>{n=o})),f(this,Nr,new sr(o=>{i=o}));const s=new G;f(this,jr,s.promise),e.readable.pipeThrough(new Vo($t)).pipeTo(new _e({write:async o=>{switch(o.id){case ze.Exit:s.resolve(o.data[0]);break;case ze.Stdout:await n.enqueue(o.data);break;case ze.Stderr:await i.enqueue(o.data);break}}})).then(()=>{n.close(),i.close(),s.reject(new Error("Socket ended without exit message"))},o=>{n.error(o),i.error(o),s.reject(o)}),r&&r.addEventListener("abort",()=>{s.reject(r.reason),l(this,ut).close()}),f(this,Zt,l(this,ut).writable.getWriter()),f(this,Dr,new Sn({write:async o=>{await l(this,Zt).write($t.serialize({id:ze.Stdin,data:o}))},close:()=>l(this,Zt).write($t.serialize({id:ze.CloseStdin,data:Y}))}))}get stdin(){return l(this,Dr)}get stdout(){return l(this,Wr)}get stderr(){return l(this,Nr)}get exited(){return l(this,jr)}kill(){return l(this,ut).close()}}ut=new WeakMap,Zt=new WeakMap,Dr=new WeakMap,Wr=new WeakMap,Nr=new WeakMap,jr=new WeakMap;var Qt,Jt,$r,Ur,dt,Fr,es;class Rc{constructor(e){d(this,Fr);d(this,Qt);d(this,Jt);d(this,$r);d(this,Ur);d(this,dt,new G);f(this,Qt,e);let r;f(this,Ur,new sr(n=>{r=n})),e.readable.pipeThrough(new Vo($t)).pipeTo(new _e({write:async n=>{switch(n.id){case ze.Exit:l(this,dt).resolve(n.data[0]);break;case ze.Stdout:await r.enqueue(n.data);break}}})).then(()=>{r.close(),l(this,dt).reject(new Error("Socket ended without exit message"))},n=>{r.error(n),l(this,dt).reject(n)}),f(this,Jt,l(this,Qt).writable.getWriter()),f(this,$r,new Sn({write:n=>N(this,Fr,es).call(this,n)}))}get input(){return l(this,$r)}get output(){return l(this,Ur)}get exited(){return l(this,dt).promise}async resize(e,r){await l(this,Jt).write($t.serialize({id:ze.WindowSizeChange,data:xt(`${e}x${r},0x0\0`)}))}sigint(){return N(this,Fr,es).call(this,new Uint8Array([3]))}kill(){return l(this,Qt).close()}}Qt=new WeakMap,Jt=new WeakMap,$r=new WeakMap,Ur=new WeakMap,dt=new WeakMap,Fr=new WeakSet,es=function(e){return l(this,Jt).write($t.serialize({id:ze.Stdin,data:e}))};var Mr;class Pc{constructor(e){d(this,Mr);f(this,Mr,e)}spawn(e,r){return r?.throwIfAborted(),typeof e=="string"&&(e=Zo(e)),l(this,Mr).call(this,e,r)}async spawnWait(e){const r=await this.spawn(e),[n,i,s]=await Promise.all([r.stdout.pipeThrough(new Qi),r.stderr.pipeThrough(new Qi),r.exited]);return{stdout:n,stderr:i,exitCode:s}}async spawnWaitText(e){const r=await this.spawn(e),[n,i,s]=await Promise.all([r.stdout.pipeThrough(new Yn).pipeThrough(new Kn),r.stderr.pipeThrough(new Yn).pipeThrough(new Kn),r.exited]);return{stdout:n,stderr:i,exitCode:s}}}Mr=new WeakMap;var Fe;class kc extends Pc{constructor(r){super(async(n,i)=>{const s=await l(this,Fe).createSocket(`shell,v2,raw:${n.join(" ")}`);if(i?.aborted)throw await s.close(),i.reason;return new Tc(s,i)});d(this,Fe);f(this,Fe,r)}get adb(){return l(this,Fe)}get isSupported(){return l(this,Fe).canUseFeature(j.ShellV2)}async pty(r){let n="shell,v2,pty";return r?.terminalType&&(n+=",TERM="+r.terminalType),n+=":",r&&(typeof r.command=="string"?n+=r.command:Array.isArray(r.command)&&(n+=r.command.join(" "))),new Rc(await l(this,Fe).createSocket(n))}}Fe=new WeakMap;var Vr,Kr,Yr;class xc{constructor(e){d(this,Vr);d(this,Kr);d(this,Yr);f(this,Vr,e),f(this,Kr,new Ec(e)),e.canUseFeature(j.ShellV2)&&f(this,Yr,new kc(e))}get adb(){return l(this,Vr)}get noneProtocol(){return l(this,Kr)}get shellProtocol(){return l(this,Yr)}}Vr=new WeakMap,Kr=new WeakMap,Yr=new WeakMap;function zc(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;r+=1)e[r]=t.charCodeAt(r);return e}function O(t){const e=zc(t);return wi(e,0)}const ie={Entry:O("DENT"),Entry2:O("DNT2"),Lstat:O("STAT"),Stat:O("STA2"),Lstat2:O("LST2"),Done:O("DONE"),Data:O("DATA"),Ok:O("OKAY"),Fail:O("FAIL")};class Cc extends Error{}const Qo=J({message:wr(_)},{littleEndian:!0,postDeserialize(t){throw new Cc(t.message)}});async function Hn(t,e,r){typeof e=="string"&&(e=O(e));const n=await t.readExactly(4);switch(wi(n,0)){case ie.Fail:throw await Qo.deserialize(t),new Error("Unreachable");case e:return await r.deserialize(t);default:throw new Error(`Expected '${e}', but got '${vn(n)}'`)}}async function*Gn(t,e,r){for(typeof e=="string"&&(e=O(e));;){const n=await t.readExactly(4);switch(wi(n,0)){case ie.Fail:await Qo.deserialize(t),fc();case ie.Done:await t.readExactly(r.size);return;case e:yield await r.deserialize(t);break;default:throw new Error(`Expected '${e}' or '${ie.Done}', but got '${vn(n)}'`)}}}const pe={List:O("LIST"),ListV2:O("LIS2"),Send:O("SEND"),SendV2:O("SND2"),Lstat:O("STAT"),Stat:O("STA2"),LstatV2:O("LST2"),Data:O("DATA"),Done:O("DONE"),Receive:O("RECV")},ao=J({id:_,arg:_},{littleEndian:!0});async function ge(t,e,r){if(typeof e=="string"&&(e=O(e)),typeof r=="number"){await t.write(ao.serialize({id:e,arg:r}));return}typeof r=="string"&&(r=xt(r)),await t.write(ao.serialize({id:e,arg:r.length})),await t.write(r)}const Jo={File:8},ea=J({mode:_,size:_,mtime:_},{littleEndian:!0,extra:{get type(){return this.mode>>12},get permission(){return this.mode&4095}},postDeserialize(t){if(t.mode===0&&t.size===0&&t.mtime===0)throw new Error("lstat error");return t}}),ta={SUCCESS:0,EACCES:13,EEXIST:17,EFAULT:14,EFBIG:27,EINTR:4,EINVAL:22,EIO:5,EISDIR:21,ELOOP:40,EMFILE:24,ENAMETOOLONG:36,ENFILE:23,ENOENT:2,ENOMEM:12,ENOSPC:28,ENOTDIR:20,EOVERFLOW:75,EPERM:1,EROFS:30,ETXTBSY:26},Ic=Object.fromEntries(Object.entries(ta).map(([t,e])=>[e,t])),Cs=J({error:_(),dev:It,ino:It,mode:_,nlink:_,uid:_,gid:_,size:It,atime:It,mtime:It,ctime:It},{littleEndian:!0,extra:{get type(){return this.mode>>12},get permission(){return this.mode&4095}},postDeserialize(t){if(t.error)throw new Error(Ic[t.error]);return t}});async function Ac(t,e,r){const n=await t.lock();try{if(r)return await ge(n,pe.LstatV2,e),await Hn(n,ie.Lstat2,Cs);{await ge(n,pe.Lstat,e);const i=await Hn(n,ie.Lstat,ea);return{mode:i.mode,size:BigInt(i.size),mtime:BigInt(i.mtime),get type(){return i.type},get permission(){return i.permission}}}}finally{n.release()}}async function Lc(t,e){const r=await t.lock();try{return await ge(r,pe.Stat,e),await Hn(r,ie.Stat,Cs)}finally{r.release()}}const Bc=ks(ea,{name:wr(_)}),qc=ks(Cs,{name:wr(_)});async function*Oc(t,e){const r=await t.lock();try{await ge(r,pe.ListV2,e);for await(const n of Gn(r,ie.Entry2,qc))n.error===ta.SUCCESS&&(yield n)}finally{r.release()}}async function*Dc(t,e){const r=await t.lock();try{await ge(r,pe.List,e);for await(const n of Gn(r,ie.Entry,Bc))yield n}finally{r.release()}}async function*Wc(t,e,r){if(r)yield*Oc(t,e);else for await(const n of Dc(t,e))yield{mode:n.mode,size:BigInt(n.size),mtime:BigInt(n.mtime),get type(){return n.type},get permission(){return n.permission},name:n.name}}const lo=J({data:_n(_)},{littleEndian:!0});async function*Nc(t,e){const r=await t.lock();let n=!1;try{await ge(r,pe.Receive,e);for await(const i of Gn(r,ie.Data,lo))yield i.data;n=!0}catch(i){throw n=!0,i}finally{if(!n)for await(const i of Gn(r,ie.Data,lo));r.release()}}function jc(t,e){return zt.from(Nc(t,e))}const ra=64*1024,$c=J({unused:_},{littleEndian:!0});async function na(t,e,r,n){const i=new yi;e.pipeThrough(new Ql(r,!0)).pipeTo(new Sn({write(s){return ge(t,pe.Data,s)}}),{signal:i.signal}).then(async()=>{await ge(t,pe.Done,n),await t.flush()},hc),await Hn(t,ie.Ok,$c).catch(s=>{throw i.abort(),s})}async function Uc({socket:t,filename:e,file:r,type:n=Jo.File,permission:i=438,mtime:s=Date.now()/1e3|0,packetSize:o=ra}){const a=await t.lock();try{const c=n<<12|i,u=`${e},${c.toString()}`;await ge(a,pe.Send,u),await na(a,r,o,s)}finally{a.release()}}const co={None:0,Brotli:1,Lz4:2,Zstd:4,DryRun:2147483648},Fc=J({id:_,mode:_,flags:_()},{littleEndian:!0});async function Mc({socket:t,filename:e,file:r,type:n=Jo.File,permission:i=438,mtime:s=Date.now()/1e3|0,packetSize:o=ra,dryRun:a=!1}){const c=await t.lock();try{await ge(c,pe.SendV2,e);const u=n<<12|i;let h=co.None;a&&(h|=co.DryRun),await c.write(Fc.serialize({id:pe.SendV2,mode:u,flags:h})),await na(c,r,o,s)}finally{c.release()}}function Vc(t){if(t.v2)return Mc(t);if(t.dryRun)throw new Error("dryRun is not supported in v1");return Uc(t)}var Hr,ht,Gr,ft,pt,Xr,ts;class Kc{constructor(e,r,n,i){d(this,Xr);d(this,Hr);d(this,ht);d(this,Gr);d(this,ft,new Yo);d(this,pt);f(this,Hr,e),f(this,ht,r),f(this,Gr,i),f(this,pt,new Mo(n))}get position(){return l(this,ht).position}async flush(){try{await l(this,ft).wait();const e=l(this,pt).flush();e&&await N(this,Xr,ts).call(this,e)}finally{l(this,ft).notifyOne()}}async write(e){try{await l(this,ft).wait();for(const r of l(this,pt).push(e))await N(this,Xr,ts).call(this,r)}finally{l(this,ft).notifyOne()}}async readExactly(e){return await this.flush(),await l(this,ht).readExactly(e)}release(){l(this,pt).flush(),l(this,Gr).notifyOne()}async close(){await l(this,ht).cancel()}}Hr=new WeakMap,ht=new WeakMap,Gr=new WeakMap,ft=new WeakMap,pt=new WeakMap,Xr=new WeakSet,ts=function(e){return ye.WritableStream.write(l(this,Hr),e)};var Zr,Qr,er;class Yc{constructor(e,r){d(this,Zr,new Yo);d(this,Qr);d(this,er);f(this,Qr,e),f(this,er,new Kc(e.writable.getWriter(),new gi(e.readable),r,l(this,Zr)))}async lock(){return await l(this,Zr).wait(),l(this,er)}async close(){await l(this,er).close(),await l(this,Qr).close()}}Zr=new WeakMap,Qr=new WeakMap,er=new WeakMap;function Hc(t){const e=t.lastIndexOf("/");if(e===-1)throw new Error("Invalid path");return e===0?"/":t.substring(0,e)}var bt,Jr,en,tn,rn;class Gc{constructor(e,r){b(this,"_adb");b(this,"_socket");d(this,bt);d(this,Jr);d(this,en);d(this,tn);d(this,rn);this._adb=e,this._socket=new Yc(r,e.maxPayloadSize),f(this,bt,e.canUseFeature(j.StatV2)),f(this,Jr,e.canUseFeature(j.ListV2)),f(this,en,e.canUseFeature(j.FixedPushMkdir)),f(this,tn,e.canUseFeature(j.SendReceiveV2)),f(this,rn,this._adb.canUseFeature(j.ShellV2)&&!this.fixedPushMkdir)}get supportsStat(){return l(this,bt)}get supportsListV2(){return l(this,Jr)}get fixedPushMkdir(){return l(this,en)}get supportsSendReceiveV2(){return l(this,tn)}get needPushMkdirWorkaround(){return l(this,rn)}async lstat(e){return await Ac(this._socket,e,l(this,bt))}async stat(e){if(!l(this,bt))throw new Error("Not supported");return await Lc(this._socket,e)}async isDirectory(e){try{return await this.lstat(e+"/"),!0}catch{return!1}}opendir(e){return Wc(this._socket,e,this.supportsListV2)}async readdir(e){const r=[];for await(const n of this.opendir(e))r.push(n);return r}read(e){return jc(this._socket,e)}async write(e){this.needPushMkdirWorkaround&&await this._adb.subprocess.noneProtocol.spawnWait(["mkdir","-p",Ji(Hc(e.filename))]),await Vc({v2:this.supportsSendReceiveV2,socket:this._socket,...e})}lockSocket(){return this._socket.lock()}dispose(){return this._socket.close()}}bt=new WeakMap,Jr=new WeakMap,en=new WeakMap,tn=new WeakMap,rn=new WeakMap;function uo(t){if(!(!t||t==="0"))return Number.parseInt(t,10)}class Xc extends zs{async getListenAddresses(){const e=await this.adb.getProp("service.adb.listen_addrs"),r=await this.adb.getProp("service.adb.tcp.port"),n=await this.adb.getProp("persist.adb.tcp.port");return{serviceListenAddresses:e!=""?e.split(","):[],servicePort:uo(r),persistPort:uo(n)}}async setPort(e){if(e<=0)throw new TypeError(`Invalid port ${e}`);const r=await this.adb.createSocketAndWait(`tcpip:${e}`);if(r!==`restarting in TCP mode port: ${e}
`)throw new Error(r);return r}async disable(){const e=await this.adb.createSocketAndWait("usb:");if(e!==`restarting in USB mode
`)throw new Error(e);return e}}var te;class Zc{constructor(e){d(this,te);b(this,"subprocess");b(this,"power");b(this,"reverse");b(this,"tcpip");f(this,te,e),this.subprocess=new xc(this),this.power=new ac(this),this.reverse=new gc(this),this.tcpip=new Xc(this)}get transport(){return l(this,te)}get serial(){return l(this,te).serial}get maxPayloadSize(){return l(this,te).maxPayloadSize}get banner(){return l(this,te).banner}get disconnected(){return l(this,te).disconnected}get clientFeatures(){return l(this,te).clientFeatures}get deviceFeatures(){return this.banner.features}canUseFeature(e){return this.clientFeatures.includes(e)&&this.deviceFeatures.includes(e)}async createSocket(e){return l(this,te).connect(e)}async createSocketAndWait(e){return await(await this.createSocket(e)).readable.pipeThrough(new Yn).pipeThrough(new Kn)}getProp(e){return this.subprocess.noneProtocol.spawnWaitText(["getprop",e]).then(r=>r.trim())}rm(e,r){const n=["rm"];if(r?.recursive&&n.push("-r"),r?.force&&n.push("-f"),Array.isArray(e))for(const i of e)n.push(Ji(i));else n.push(Ji(e));return n.push("</dev/null"),this.subprocess.noneProtocol.spawnWaitText(n)}async sync(){const e=await this.createSocket("sync:");return new Gc(this,e)}async framebuffer(){return oc(this)}async close(){await l(this,te).close()}}te=new WeakMap;const Pn={Product:"ro.product.name",Model:"ro.product.model",Device:"ro.product.device",Features:"features"};var nn,sn,on,an;const no=class no{constructor(e,r,n,i){d(this,nn);d(this,sn);d(this,on);d(this,an,[]);f(this,nn,e),f(this,sn,r),f(this,on,n),f(this,an,i)}static parse(e){let r,n,i,s=[];const o=e.split("::");if(o.length>1){const a=o[1];for(const c of a.split(";")){if(!c)continue;const u=c.split("=");if(u.length!==2)continue;const[h,m]=u;switch(h){case Pn.Product:r=m;break;case Pn.Model:n=m;break;case Pn.Device:i=m;break;case Pn.Features:s=m.split(",");break}}}return new no(r,n,i,s)}get product(){return l(this,nn)}get model(){return l(this,sn)}get device(){return l(this,on)}get features(){return l(this,an)}};nn=new WeakMap,sn=new WeakMap,on=new WeakMap,an=new WeakMap;let rs=no;function ns(t,e,r){let n=0n;for(let i=e;i<e+r;i+=8){n<<=64n;const s=Dl(t,i);n|=s}return n}function is(t,e,r,n,i){if(i)for(;n>0n;)Al(t,e,n),e+=8,n>>=64n;else{let s=e+r-8;for(;n>0n;)Ll(t,s,n),s-=8,n>>=64n}}const Qc=38,Jc=2048/8,eu=303,tu=2048/8;function ia(t){const e=ns(t,Qc,Jc),r=ns(t,eu,tu);return[e,r]}function ho(t,e){const r=t%e;return r>0?r:r+e}function ru(t,e){if(t=ho(t,e),!t||e<2)return NaN;const r=[];let n=e;for(;n;)[t,n]=[n,t%n],r.push({a:t,b:n});if(t!==1)return NaN;let i=1,s=0;for(let o=r.length-2;o>=0;o-=1)[i,s]=[s,i-s*Math.floor(r[o].a/r[o].b)];return ho(s,e)}const it=2048/8,nu=it/4;function sa(){return 8+it+it+4}function iu(t,e){let r;const n=sa();if(!e)e=new Uint8Array(n),r="Uint8Array";else{if(e.length<n)throw new TypeError("output buffer is too small");r="number"}const i=new DataView(e.buffer,e.byteOffset,e.length);let s=0;i.setUint32(s,nu,!0),s+=4;const[o]=ia(t),a=-ru(Number(o%2n**32n),2**32);i.setInt32(s,a,!0),s+=4,is(e,s,it,o,!0),s+=it;const c=2n**4096n%o;return is(e,s,it,c,!0),s+=it,i.setUint32(s,65537,!0),s+=4,r==="Uint8Array"?e:n}function su(t,e,r){if(r===1n)return 0n;let n=1n;for(t=t%r;e>0n;)BigInt.asUintN(1,e)===1n&&(n=n*t%r),t=t*t%r,e>>=1n;return n}const fo=20,po=48,ou=4,au=5,lu=6,Ci=new Uint8Array([po,13+fo,po,9,lu,5,1*40+3,14,3,2,26,au,0,ou,fo]);function cu(t,e){const[r,n]=ia(t),i=new Uint8Array(256);let s=0;i[s]=0,s+=1,i[s]=1,s+=1;const o=i.length-Ci.length-e.length-1;for(;s<o;)i[s]=255,s+=1;i[s]=0,s+=1,i.set(Ci,s),s+=Ci.length,i.set(e,s);const a=su(ns(i,0,i.length),n,r);return is(i,0,i.length,a,!1),i}const K={Auth:1213486401,Close:1163086915,Connect:1314410051,Okay:1497451343,Open:1313165391,Write:1163154007};function oa(t){return t.reduce((e,r)=>e+r,0)}const Xn={Token:1,Signature:2,PublicKey:3},uu=async function*(t,e){for await(const r of t.iterateKeys()){const n=await e();if(n.arg0!==Xn.Token)return;const i=cu(r.buffer,n.payload);yield{command:K.Auth,arg0:Xn.Signature,arg1:0,payload:i}}},du=async function*(t,e){if((await e()).arg0!==Xn.Token)return;let n;for await(const c of t.iterateKeys()){n=c;break}n||(n=await t.generateKey());const i=sa(),[s]=Ho(i),o=n.name?.length?xt(n.name):Y,a=new Uint8Array(s+(o.length?o.length+1:0)+1);iu(n.buffer,a),lc(a.subarray(0,i),a),o.length&&(a[s]=32,a.set(o,s+1)),yield{command:K.Auth,arg0:Xn.PublicKey,arg1:0,payload:a}},hu=[uu,du];var ln,tr,mt,di,hi,aa;class fu{constructor(e,r){d(this,hi);b(this,"authenticators");d(this,ln);d(this,tr,new G);d(this,mt);d(this,di,()=>l(this,tr).promise);this.authenticators=e,f(this,ln,r)}async process(e){l(this,mt)||f(this,mt,N(this,hi,aa).call(this)),l(this,tr).resolve(e);const r=await l(this,mt).next();if(r.done)throw new Error("No authenticator can handle the request");return r.value}dispose(){l(this,mt)?.return?.()}}ln=new WeakMap,tr=new WeakMap,mt=new WeakMap,di=new WeakMap,hi=new WeakSet,aa=async function*(){for(const e of this.authenticators)for await(const r of e(l(this,ln),l(this,di)))f(this,tr,new G),yield r};var wt,cn,rr,un,dn,hn,fn,yt,xe,fi,la;class bo{constructor(e){d(this,fi);d(this,wt);b(this,"localId");b(this,"remoteId");b(this,"localCreated");b(this,"service");d(this,cn);d(this,rr);d(this,un);b(this,"writable");d(this,dn,!1);d(this,hn,new G);d(this,fn);d(this,yt);d(this,xe,0);f(this,wt,e.dispatcher),this.localId=e.localId,this.remoteId=e.remoteId,this.localCreated=e.localCreated,this.service=e.service,f(this,cn,new sr(r=>{f(this,rr,r)})),this.writable=new Sn({start:r=>{f(this,un,r),r.signal.addEventListener("abort",()=>{l(this,yt)?.reject(r.signal.reason)})},write:async r=>{const n=r.length,i=l(this,wt).options.maxPayloadSize;for(let s=0,o=i;s<n;s=o,o+=i){const a=r.subarray(s,o);await N(this,fi,la).call(this,a)}}}),f(this,fn,new pu(this)),f(this,xe,e.availableWriteBytes)}get readable(){return l(this,cn)}get closed(){return l(this,hn).promise}get socket(){return l(this,fn)}async enqueue(e){await l(this,rr).enqueue(e)}ack(e){f(this,xe,l(this,xe)+e),l(this,yt)?.resolve()}async close(){if(!l(this,dn)){f(this,dn,!0),l(this,yt)?.reject(new Error("Socket closed"));try{l(this,un).error(new Error("Socket closed"))}catch{}await l(this,wt).sendPacket(K.Close,this.localId,this.remoteId,Y)}}dispose(){l(this,rr).close(),l(this,hn).resolve(void 0)}}wt=new WeakMap,cn=new WeakMap,rr=new WeakMap,un=new WeakMap,dn=new WeakMap,hn=new WeakMap,fn=new WeakMap,yt=new WeakMap,xe=new WeakMap,fi=new WeakSet,la=async function(e){const r=e.length;for(;l(this,xe)<r;){const n=new G;f(this,yt,n),await n.promise}l(this,xe)===1/0?f(this,xe,-1):f(this,xe,l(this,xe)-r),await l(this,wt).sendPacket(K.Write,this.localId,this.remoteId,e)};var re;class pu{constructor(e){d(this,re);f(this,re,e)}get localId(){return l(this,re).localId}get remoteId(){return l(this,re).remoteId}get localCreated(){return l(this,re).localCreated}get service(){return l(this,re).service}get readable(){return l(this,re).readable}get writable(){return l(this,re).writable}get closed(){return l(this,re).closed}close(){return l(this,re).close()}}re=new WeakMap;var Me,ue,gt,pn,nr,_t,bn,H,ca,ua,ss,da,ha,os;class bu{constructor(e,r){d(this,H);d(this,Me,new Rl(1));d(this,ue,new Map);d(this,gt);b(this,"options");d(this,pn,!1);d(this,nr,new G);d(this,_t,new Map);d(this,bn,new yi);this.options=r,this.options.initialDelayedAckBytes<0&&(this.options.initialDelayedAckBytes=0),e.readable.pipeTo(new _e({write:async(n,i)=>{switch(n.command){case K.Close:await N(this,H,ca).call(this,n);break;case K.Okay:N(this,H,ua).call(this,n);break;case K.Open:await N(this,H,da).call(this,n);break;case K.Write:N(this,H,ha).call(this,n).catch(s=>{i.error(s)});break;default:throw new Error(`Unknown command: ${n.command.toString(16)}`)}}}),{preventCancel:r.preserveConnection??!1,signal:l(this,bn).signal}).then(()=>{N(this,H,os).call(this)},n=>{l(this,pn)||l(this,nr).reject(n),N(this,H,os).call(this)}),f(this,gt,e.writable.getWriter())}get disconnected(){return l(this,nr).promise}async createSocket(e){this.options.appendNullToServiceString&&(e+="\0");const[r,n]=l(this,Me).add();await this.sendPacket(K.Open,r,this.options.initialDelayedAckBytes,e);const{remoteId:i,availableWriteBytes:s}=await n,o=new bo({dispatcher:this,localId:r,remoteId:i,localCreated:!0,service:e,availableWriteBytes:s});return l(this,ue).set(r,o),o.socket}addReverseTunnel(e,r){l(this,_t).set(e,r)}removeReverseTunnel(e){l(this,_t).delete(e)}clearReverseTunnels(){l(this,_t).clear()}async sendPacket(e,r,n,i){if(typeof i=="string"&&(i=xt(i)),i.length>this.options.maxPayloadSize)throw new TypeError("payload too large");await ye.WritableStream.write(l(this,gt),{command:e,arg0:r,arg1:n,payload:i,checksum:this.options.calculateChecksum?oa(i):0,magic:e^4294967295})}async close(){await Promise.all(Array.from(l(this,ue).values(),e=>e.close())),f(this,pn,!0),l(this,bn).abort(),this.options.preserveConnection?l(this,gt).releaseLock():await l(this,gt).close()}}Me=new WeakMap,ue=new WeakMap,gt=new WeakMap,pn=new WeakMap,nr=new WeakMap,_t=new WeakMap,bn=new WeakMap,H=new WeakSet,ca=async function(e){if(e.arg0===0&&l(this,Me).reject(e.arg1,new Error("Socket open failed")))return;const r=l(this,ue).get(e.arg1);if(r){await r.close(),r.dispose(),l(this,ue).delete(e.arg1);return}},ua=function(e){let r;if(this.options.initialDelayedAckBytes!==0){if(e.payload.length!==4)throw new Error("Invalid OKAY packet. Payload size should be 4");r=wi(e.payload,0)}else{if(e.payload.length!==0)throw new Error("Invalid OKAY packet. Payload size should be 0");r=1/0}if(l(this,Me).resolve(e.arg1,{remoteId:e.arg0,availableWriteBytes:r}))return;const n=l(this,ue).get(e.arg1);if(n){n.ack(r);return}this.sendPacket(K.Close,e.arg1,e.arg0,Y)},ss=function(e,r,n){let i;return this.options.initialDelayedAckBytes!==0?(i=new Uint8Array(4),ql(i,0,n)):i=Y,this.sendPacket(K.Okay,e,r,i)},da=async function(e){const[r]=l(this,Me).add();l(this,Me).resolve(r,void 0);const n=e.arg0;let i=e.arg1,s=vn(e.payload);if(s.endsWith("\0")&&(s=s.substring(0,s.length-1)),this.options.initialDelayedAckBytes===0){if(i!==0)throw new Error("Invalid OPEN packet. arg1 should be 0");i=1/0}else if(i===0)throw new Error("Invalid OPEN packet. arg1 should be greater than 0");const o=l(this,_t).get(s);if(!o){await this.sendPacket(K.Close,0,n,Y);return}const a=new bo({dispatcher:this,localId:r,remoteId:n,localCreated:!1,service:s,availableWriteBytes:i});try{await o(a.socket),l(this,ue).set(r,a),await N(this,H,ss).call(this,r,n,this.options.initialDelayedAckBytes)}catch{await this.sendPacket(K.Close,0,n,Y)}},ha=async function(e){const r=l(this,ue).get(e.arg1);if(!r)throw new Error(`Unknown local socket id: ${e.arg1}`);let n=!1;const i=[(async()=>{await r.enqueue(e.payload),await N(this,H,ss).call(this,e.arg1,e.arg0,e.payload.length),n=!0})()];this.options.readTimeLimit&&i.push((async()=>{if(await Pl(this.options.readTimeLimit),!n)throw new Error(`readable of \`${r.service}\` has stalled for ${this.options.readTimeLimit} milliseconds`)})()),await Promise.race(i)},os=function(){for(const e of l(this,ue).values())e.dispose();l(this,nr).resolve()};const mu=16777217,mo=[j.ShellV2,j.Cmd,j.StatV2,j.ListV2,j.FixedPushMkdir,"apex",j.Abb,"fixed_push_symlink_timestamp",j.AbbExec,"remount_shell","track_app",j.SendReceiveV2,"sendrecv_v2_brotli","sendrecv_v2_lz4","sendrecv_v2_zstd","sendrecv_v2_dry_run_send",j.DelayedAck],wu=32*1024*1024;var mn,de,wn,yn,ir,gn;const io=class io{constructor({serial:e,connection:r,version:n,banner:i,features:s=mo,initialDelayedAckBytes:o,...a}){d(this,mn);d(this,de);d(this,wn);d(this,yn);d(this,ir);d(this,gn);if(f(this,wn,e),f(this,mn,r),f(this,ir,rs.parse(i)),f(this,gn,s),s.includes(j.DelayedAck)){if(o<=0)throw new TypeError("`initialDelayedAckBytes` must be greater than 0 when DelayedAck feature is enabled.");l(this,ir).features.includes(j.DelayedAck)||(o=0)}else o=0;let c,u;n>=mu?(c=!1,u=!1):(c=!0,u=!0),f(this,de,new bu(r,{calculateChecksum:c,appendNullToServiceString:u,initialDelayedAckBytes:o,...a})),f(this,yn,n)}static async authenticate({serial:e,connection:r,credentialStore:n,authenticators:i=hu,features:s=mo,initialDelayedAckBytes:o=wu,...a}){let c=16777217,u=1024*1024;const h=new G,m=new fu(i,n),p=new yi,g=r.readable.pipeTo(new _e({async write(w){switch(w.command){case K.Connect:c=Math.min(c,w.arg0),u=Math.min(u,w.arg1),h.resolve(vn(w.payload));break;case K.Auth:{const R=await m.process(w);await I(R);break}}}}),{preventCancel:!0,signal:p.signal}).then(()=>{h.reject(new Error("Connection closed unexpectedly"))},w=>{h.reject(w)}),T=r.writable.getWriter();async function I(w){w.checksum=oa(w.payload),w.magic=w.command^4294967295,await ye.WritableStream.write(T,w)}const q=s.slice();if(o<=0){const w=s.indexOf(j.DelayedAck);w!==-1&&q.splice(w,1)}let C;try{await I({command:K.Connect,arg0:c,arg1:u,payload:xt(`host::features=${q.join(",")}`)}),C=await h.promise}finally{p.abort(),T.releaseLock(),await g}return new io({serial:e,connection:r,version:c,maxPayloadSize:u,banner:C,features:q,initialDelayedAckBytes:o,...a})}get connection(){return l(this,mn)}get serial(){return l(this,wn)}get protocolVersion(){return l(this,yn)}get maxPayloadSize(){return l(this,de).options.maxPayloadSize}get banner(){return l(this,ir)}get disconnected(){return l(this,de).disconnected}get clientFeatures(){return l(this,gn)}connect(e){return l(this,de).createSocket(e)}addReverseTunnel(e,r){return r||(r=`localabstract:reverse_${Math.random().toString().substring(2)}`),l(this,de).addReverseTunnel(r,e),r}removeReverseTunnel(e){l(this,de).removeReverseTunnel(e)}clearReverseTunnels(){l(this,de).clearReverseTunnels()}close(){return l(this,de).close()}};mn=new WeakMap,de=new WeakMap,wn=new WeakMap,yn=new WeakMap,ir=new WeakMap,gn=new WeakMap;let as=io;var fa=function(){function t(){var e=this;this._state="running",this.resolve=function(r){e._resolve(r),e._state="resolved"},this.reject=function(r){e._reject(r),e._state="rejected"},this._promise=new Promise(function(r,n){e._resolve=r,e._reject=n})}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),t}();/**
 * @license
 * web-streams-polyfill v4.2.0
 * Copyright 2025 Mattias Buelens, Diwank Singh Tomer and other contributors.
 * This code is released under the MIT license.
 * SPDX-License-Identifier: MIT
 */function yr(){}function $(t){return typeof t=="object"&&t!==null||typeof t=="function"}const pa=yr;function x(t,e){try{Object.defineProperty(t,"name",{value:e,configurable:!0})}catch{}}const Is=Promise,yu=Promise.resolve.bind(Is),gu=Promise.prototype.then,_u=Promise.reject.bind(Is),vu=yu;function W(t){return new Is(t)}function z(t){return W(e=>e(t))}function y(t){return _u(t)}function me(t,e,r){return gu.call(t,e,r)}function Q(t,e,r){me(me(t,e,r),void 0,pa)}function Ii(t,e){Q(t,e)}function ls(t,e){Q(t,void 0,e)}function Ae(t,e,r){return me(t,e,r)}function lr(t){me(t,void 0,pa)}let vt=t=>{if(typeof queueMicrotask=="function")vt=queueMicrotask;else{const e=z(void 0);vt=r=>me(e,r)}return vt(t)};function St(t,e,r){if(typeof t!="function")throw new TypeError("Argument is not a function");return Function.prototype.apply.call(t,e,r)}function Be(t,e,r){try{return z(St(t,e,r))}catch(n){return y(n)}}class se{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const r=this._back;let n=r;r._elements.length===16383&&(n={_elements:[],_next:void 0}),r._elements.push(e),n!==r&&(this._back=n,r._next=n),++this._size}shift(){const e=this._front;let r=e;const n=this._cursor;let i=n+1;const s=e._elements,o=s[n];return i===16384&&(r=e._next,i=0),--this._size,this._cursor=i,e!==r&&(this._front=r),s[n]=void 0,o}forEach(e){let r=this._cursor,n=this._front,i=n._elements;for(;!(r===i.length&&n._next===void 0||r===i.length&&(n=n._next,i=n._elements,r=0,i.length===0));)e(i[r]),++r}peek(){const e=this._front,r=this._cursor;return e._elements[r]}}const ba=Symbol("[[AbortSteps]]"),ma=Symbol("[[ErrorSteps]]"),As=Symbol("[[CancelSteps]]"),Ls=Symbol("[[PullSteps]]"),Bs=Symbol("[[ReleaseSteps]]");function wa(t,e){t._ownerReadableStream=e,e._reader=t,e._state==="readable"?cs(t):e._state==="closed"?function(r){cs(r),ga(r)}(t):ya(t,e._storedError)}function qs(t,e){return he(t._ownerReadableStream,e)}function Ce(t){const e=t._ownerReadableStream;e._state==="readable"?Os(t,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(r,n){ya(r,n)}(t,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._readableStreamController[Bs](),e._reader=void 0,t._ownerReadableStream=void 0}function Zn(t){return new TypeError("Cannot "+t+" a stream using a released reader")}function cs(t){t._closedPromise=W((e,r)=>{t._closedPromise_resolve=e,t._closedPromise_reject=r})}function ya(t,e){cs(t),Os(t,e)}function Os(t,e){t._closedPromise_reject!==void 0&&(lr(t._closedPromise),t._closedPromise_reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0)}function ga(t){t._closedPromise_resolve!==void 0&&(t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0)}const wo=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)},Su=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};function Ie(t,e){if(t!==void 0&&typeof(r=t)!="object"&&typeof r!="function")throw new TypeError(`${e} is not an object.`);var r}function oe(t,e){if(typeof t!="function")throw new TypeError(`${e} is not a function.`)}function _a(t,e){if(!function(r){return typeof r=="object"&&r!==null||typeof r=="function"}(t))throw new TypeError(`${e} is not an object.`)}function Et(t,e,r){if(t===void 0)throw new TypeError(`Parameter ${e} is required in '${r}'.`)}function yo(t,e,r){if(t===void 0)throw new TypeError(`${e} is required in '${r}'.`)}function va(t){return Number(t)}function go(t){return t===0?0:t}function Ds(t,e){const r=Number.MAX_SAFE_INTEGER;let n=Number(t);if(n=go(n),!wo(n))throw new TypeError(`${e} is not a finite number`);if(n=function(i){return go(Su(i))}(n),n<0||n>r)throw new TypeError(`${e} is outside the accepted range of 0 to ${r}, inclusive`);return wo(n)&&n!==0?n:0}function Ws(t,e){if(!qe(t))throw new TypeError(`${e} is not a ReadableStream.`)}function Ut(t){return new et(t)}function Sa(t,e){t._reader._readRequests.push(e)}function Ns(t,e,r){const n=t._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(e)}function vi(t){return t._reader._readRequests.length}function Ea(t){const e=t._reader;return e!==void 0&&!!Ve(e)}class et{constructor(e){if(Et(e,1,"ReadableStreamDefaultReader"),Ws(e,"First parameter"),Ke(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");wa(this,e),this._readRequests=new se}get closed(){return Ve(this)?this._closedPromise:y(kn("closed"))}cancel(e=void 0){return Ve(this)?this._ownerReadableStream===void 0?y(Zn("cancel")):qs(this,e):y(kn("cancel"))}read(){if(!Ve(this))return y(kn("read"));if(this._ownerReadableStream===void 0)return y(Zn("read from"));let e,r;const n=W((i,s)=>{e=i,r=s});return gr(this,{_chunkSteps:i=>e({value:i,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:i=>r(i)}),n}releaseLock(){if(!Ve(this))throw kn("releaseLock");this._ownerReadableStream!==void 0&&function(e){Ce(e);const r=new TypeError("Reader was released");Ta(e,r)}(this)}}function Ve(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readRequests")&&t instanceof et}function gr(t,e){const r=t._ownerReadableStream;r._disturbed=!0,r._state==="closed"?e._closeSteps():r._state==="errored"?e._errorSteps(r._storedError):r._readableStreamController[Ls](e)}function Ta(t,e){const r=t._readRequests;t._readRequests=new se,r.forEach(n=>{n._errorSteps(e)})}function kn(t){return new TypeError(`ReadableStreamDefaultReader.prototype.${t} can only be used on a ReadableStreamDefaultReader`)}var Ai,Li,Bi;function dr(t){return t.slice()}function Ra(t,e,r,n,i){new Uint8Array(t).set(new Uint8Array(r,n,i),e)}Object.defineProperties(et.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),x(et.prototype.cancel,"cancel"),x(et.prototype.read,"read"),x(et.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(et.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});let Tt=t=>(Tt=typeof t.transfer=="function"?e=>e.transfer():typeof structuredClone=="function"?e=>structuredClone(e,{transfer:[e]}):e=>e,Tt(t)),Rt=t=>(Rt=typeof t.detached=="boolean"?e=>e.detached:e=>e.byteLength===0,Rt(t));function Pa(t,e,r){if(t.slice)return t.slice(e,r);const n=r-e,i=new ArrayBuffer(n);return Ra(i,0,t,e,n),i}function hr(t,e){const r=t[e];if(r!=null){if(typeof r!="function")throw new TypeError(`${String(e)} is not a function`);return r}}function _o(t){try{const e=t.done,r=t.value;return me(vu(r),n=>({done:e,value:n}))}catch(e){return y(e)}}const En=(Bi=(Ai=Symbol.asyncIterator)!==null&&Ai!==void 0?Ai:(Li=Symbol.for)===null||Li===void 0?void 0:Li.call(Symbol,"Symbol.asyncIterator"))!==null&&Bi!==void 0?Bi:"@@asyncIterator";function ka(t,e="sync",r){if(r===void 0)if(e==="async"){if((r=hr(t,En))===void 0)return function(i){const s={next(){let o;try{o=xa(i)}catch(a){return y(a)}return _o(o)},return(o){let a;try{const c=hr(i.iterator,"return");if(c===void 0)return z({done:!0,value:o});a=St(c,i.iterator,[o])}catch(c){return y(c)}return $(a)?_o(a):y(new TypeError("The iterator.return() method must return an object"))}};return{iterator:s,nextMethod:s.next,done:!1}}(ka(t,"sync",hr(t,Symbol.iterator)))}else r=hr(t,Symbol.iterator);if(r===void 0)throw new TypeError("The object is not iterable");const n=St(r,t,[]);if(!$(n))throw new TypeError("The iterator method must return an object");return{iterator:n,nextMethod:n.next,done:!1}}function xa(t){const e=St(t.nextMethod,t.iterator,[]);if(!$(e))throw new TypeError("The iterator.next() method must return an object");return e}class za{constructor(e,r){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=r}next(){const e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?Ae(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){const r=()=>this._returnSteps(e);return this._ongoingPromise=this._ongoingPromise?Ae(this._ongoingPromise,r,r):r(),this._ongoingPromise}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const e=this._reader;let r,n;const i=W((s,o)=>{r=s,n=o});return gr(e,{_chunkSteps:s=>{this._ongoingPromise=void 0,vt(()=>r({value:s,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Ce(e),r({value:void 0,done:!0})},_errorSteps:s=>{this._ongoingPromise=void 0,this._isFinished=!0,Ce(e),n(s)}}),i}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;const r=this._reader;if(!this._preventCancel){const n=qs(r,e);return Ce(r),Ae(n,()=>({value:e,done:!0}))}return Ce(r),z({value:e,done:!0})}}const Ca={next(){return vo(this)?this._asyncIteratorImpl.next():y(So("next"))},return(t){return vo(this)?this._asyncIteratorImpl.return(t):y(So("return"))},[En](){return this}};function vo(t){if(!$(t)||!Object.prototype.hasOwnProperty.call(t,"_asyncIteratorImpl"))return!1;try{return t._asyncIteratorImpl instanceof za}catch{return!1}}function So(t){return new TypeError(`ReadableStreamAsyncIterator.${t} can only be used on a ReadableSteamAsyncIterator`)}Object.defineProperty(Ca,En,{enumerable:!1});const Ia=Number.isNaN||function(t){return t!=t};function Eo(t){const e=Pa(t.buffer,t.byteOffset,t.byteOffset+t.byteLength);return new Uint8Array(e)}function us(t){const e=t._queue.shift();return t._queueTotalSize-=e.size,t._queueTotalSize<0&&(t._queueTotalSize=0),e.value}function js(t,e,r){if(typeof(n=r)!="number"||Ia(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;t._queue.push({value:e,size:r}),t._queueTotalSize+=r}function Xe(t){t._queue=new se,t._queueTotalSize=0}function Aa(t){return t===DataView}class Ot{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!qi(this))throw Oi("view");return this._view}respond(e){if(!qi(this))throw Oi("respond");if(Et(e,1,"respond"),e=Ds(e,"First parameter"),this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Rt(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");Wn(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!qi(this))throw Oi("respondWithNewView");if(Et(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(this._associatedReadableByteStreamController===void 0)throw new TypeError("This BYOB request has been invalidated");if(Rt(e.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");Nn(this._associatedReadableByteStreamController,e)}}Object.defineProperties(Ot.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),x(Ot.prototype.respond,"respond"),x(Ot.prototype.respondWithNewView,"respondWithNewView"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ot.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class De{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!tt(this))throw cr("byobRequest");return hs(this)}get desiredSize(){if(!tt(this))throw cr("desiredSize");return Fa(this)}close(){if(!tt(this))throw cr("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if(e!=="readable")throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);fr(this)}enqueue(e){if(!tt(this))throw cr("enqueue");if(Et(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(e.byteLength===0)throw new TypeError("chunk must have non-zero byteLength");if(e.buffer.byteLength===0)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const r=this._controlledReadableByteStream._state;if(r!=="readable")throw new TypeError(`The stream (in ${r} state) is not in the readable state and cannot be enqueued to`);Dn(this,e)}error(e=void 0){if(!tt(this))throw cr("error");ne(this,e)}[As](e){La(this),Xe(this);const r=this._cancelAlgorithm(e);return Si(this),r}[Ls](e){const r=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void Ua(this,e);const n=this._autoAllocateChunkSize;if(n!==void 0){let i;try{i=new ArrayBuffer(n)}catch(o){return void e._errorSteps(o)}const s={buffer:i,bufferByteLength:n,byteOffset:0,byteLength:n,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(s)}Sa(r,e),Ct(this)}[Bs](){if(this._pendingPullIntos.length>0){const e=this._pendingPullIntos.peek();e.readerType="none",this._pendingPullIntos=new se,this._pendingPullIntos.push(e)}}}function tt(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledReadableByteStream")&&t instanceof De}function qi(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_associatedReadableByteStreamController")&&t instanceof Ot}function Ct(t){if(function(r){const n=r._controlledReadableByteStream;return n._state!=="readable"||r._closeRequested||!r._started?!1:!!(Ea(n)&&vi(n)>0||Us(n)&&Ka(n)>0||Fa(r)>0)}(t)){if(t._pulling)return void(t._pullAgain=!0);t._pulling=!0,Q(t._pullAlgorithm(),()=>(t._pulling=!1,t._pullAgain&&(t._pullAgain=!1,Ct(t)),null),r=>(ne(t,r),null))}}function La(t){$s(t),t._pendingPullIntos=new se}function Ba(t,e){let r=!1;t._state==="closed"&&(r=!0);const n=qa(e);e.readerType==="default"?Ns(t,n,r):function(i,s,o){const a=i._reader,c=a._readIntoRequests.shift();o?c._closeSteps(s):c._chunkSteps(s)}(t,n,r)}function qn(t,e){for(let r=0;r<e.length;++r)Ba(t,e[r])}function qa(t){const e=t.bytesFilled,r=t.elementSize;return new t.viewConstructor(t.buffer,t.byteOffset,e/r)}function On(t,e,r,n){t._queue.push({buffer:e,byteOffset:r,byteLength:n}),t._queueTotalSize+=n}function Oa(t,e,r,n){let i;try{i=Pa(e,r,r+n)}catch(s){throw ne(t,s),s}On(t,i,0,n)}function Da(t,e){e.bytesFilled>0&&Oa(t,e.buffer,e.byteOffset,e.bytesFilled),Ft(t)}function Wa(t,e){const r=Math.min(t._queueTotalSize,e.byteLength-e.bytesFilled),n=e.bytesFilled+r;let i=r,s=!1;const o=n-n%e.elementSize;o>=e.minimumFill&&(i=o-e.bytesFilled,s=!0);const a=t._queue;for(;i>0;){const c=a.peek(),u=Math.min(i,c.byteLength),h=e.byteOffset+e.bytesFilled;Ra(e.buffer,h,c.buffer,c.byteOffset,u),c.byteLength===u?a.shift():(c.byteOffset+=u,c.byteLength-=u),t._queueTotalSize-=u,Na(t,u,e),i-=u}return s}function Na(t,e,r){r.bytesFilled+=e}function ja(t){t._queueTotalSize===0&&t._closeRequested?(Si(t),Tn(t._controlledReadableByteStream)):Ct(t)}function $s(t){t._byobRequest!==null&&(t._byobRequest._associatedReadableByteStreamController=void 0,t._byobRequest._view=null,t._byobRequest=null)}function ds(t){const e=[];for(;t._pendingPullIntos.length>0&&t._queueTotalSize!==0;){const r=t._pendingPullIntos.peek();Wa(t,r)&&(Ft(t),e.push(r))}return e}function Eu(t,e,r,n){const i=t._controlledReadableByteStream,s=e.constructor,o=function(p){return Aa(p)?1:p.BYTES_PER_ELEMENT}(s),{byteOffset:a,byteLength:c}=e,u=r*o;let h;try{h=Tt(e.buffer)}catch(p){return void n._errorSteps(p)}const m={buffer:h,bufferByteLength:h.byteLength,byteOffset:a,byteLength:c,bytesFilled:0,minimumFill:u,elementSize:o,viewConstructor:s,readerType:"byob"};if(t._pendingPullIntos.length>0)return t._pendingPullIntos.push(m),void To(i,n);if(i._state==="closed"){const p=new s(m.buffer,m.byteOffset,0);return void n._closeSteps(p)}if(t._queueTotalSize>0){if(Wa(t,m)){const p=qa(m);return ja(t),void n._chunkSteps(p)}if(t._closeRequested){const p=new TypeError("Insufficient bytes to fill elements in the given buffer");return ne(t,p),void n._errorSteps(p)}}t._pendingPullIntos.push(m),To(i,n),Ct(t)}function $a(t,e){const r=t._pendingPullIntos.peek();$s(t),t._controlledReadableByteStream._state==="closed"?function(n,i){i.readerType==="none"&&Ft(n);const s=n._controlledReadableByteStream;if(Us(s)){const o=[];for(;o.length<Ka(s);)o.push(Ft(n));qn(s,o)}}(t,r):function(n,i,s){if(Na(0,i,s),s.readerType==="none"){Da(n,s);const c=ds(n);return void qn(n._controlledReadableByteStream,c)}if(s.bytesFilled<s.minimumFill)return;Ft(n);const o=s.bytesFilled%s.elementSize;if(o>0){const c=s.byteOffset+s.bytesFilled;Oa(n,s.buffer,c-o,o)}s.bytesFilled-=o;const a=ds(n);Ba(n._controlledReadableByteStream,s),qn(n._controlledReadableByteStream,a)}(t,e,r),Ct(t)}function Ft(t){return t._pendingPullIntos.shift()}function Si(t){t._pullAlgorithm=void 0,t._cancelAlgorithm=void 0}function fr(t){const e=t._controlledReadableByteStream;if(!t._closeRequested&&e._state==="readable")if(t._queueTotalSize>0)t._closeRequested=!0;else{if(t._pendingPullIntos.length>0){const r=t._pendingPullIntos.peek();if(r.bytesFilled%r.elementSize!==0){const n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw ne(t,n),n}}Si(t),Tn(e)}}function Dn(t,e){const r=t._controlledReadableByteStream;if(t._closeRequested||r._state!=="readable")return;const{buffer:n,byteOffset:i,byteLength:s}=e;if(Rt(n))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");const o=Tt(n);if(t._pendingPullIntos.length>0){const a=t._pendingPullIntos.peek();if(Rt(a.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");$s(t),a.buffer=Tt(a.buffer),a.readerType==="none"&&Da(t,a)}Ea(r)?(function(a){const c=a._controlledReadableByteStream._reader;for(;c._readRequests.length>0;){if(a._queueTotalSize===0)return;Ua(a,c._readRequests.shift())}}(t),vi(r)===0?On(t,o,i,s):(t._pendingPullIntos.length>0&&Ft(t),Ns(r,new Uint8Array(o,i,s),!1))):Us(r)?(On(t,o,i,s),qn(r,ds(t))):On(t,o,i,s),Ct(t)}function ne(t,e){const r=t._controlledReadableByteStream;r._state==="readable"&&(La(t),Xe(t),Si(t),hl(r,e))}function Ua(t,e){const r=t._queue.shift();t._queueTotalSize-=r.byteLength,ja(t);const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);e._chunkSteps(n)}function hs(t){if(t._byobRequest===null&&t._pendingPullIntos.length>0){const e=t._pendingPullIntos.peek(),r=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled),n=Object.create(Ot.prototype);(function(i,s,o){i._associatedReadableByteStreamController=s,i._view=o})(n,t,r),t._byobRequest=n}return t._byobRequest}function Fa(t){const e=t._controlledReadableByteStream._state;return e==="errored"?null:e==="closed"?0:t._strategyHWM-t._queueTotalSize}function Wn(t,e){const r=t._pendingPullIntos.peek();if(t._controlledReadableByteStream._state==="closed"){if(e!==0)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(e===0)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+e>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=Tt(r.buffer),$a(t,e)}function Nn(t,e){const r=t._pendingPullIntos.peek();if(t._controlledReadableByteStream._state==="closed"){if(e.byteLength!==0)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(e.byteLength===0)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==e.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==e.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+e.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=e.byteLength;r.buffer=Tt(e.buffer),$a(t,n)}function Ma(t,e,r,n,i,s,o){e._controlledReadableByteStream=t,e._pullAgain=!1,e._pulling=!1,e._byobRequest=null,e._queue=e._queueTotalSize=void 0,Xe(e),e._closeRequested=!1,e._started=!1,e._strategyHWM=s,e._pullAlgorithm=n,e._cancelAlgorithm=i,e._autoAllocateChunkSize=o,e._pendingPullIntos=new se,t._readableStreamController=e,Q(z(r()),()=>(e._started=!0,Ct(e),null),a=>(ne(e,a),null))}function Oi(t){return new TypeError(`ReadableStreamBYOBRequest.prototype.${t} can only be used on a ReadableStreamBYOBRequest`)}function cr(t){return new TypeError(`ReadableByteStreamController.prototype.${t} can only be used on a ReadableByteStreamController`)}function Tu(t,e){if((t=`${t}`)!="byob")throw new TypeError(`${e} '${t}' is not a valid enumeration value for ReadableStreamReaderMode`);return t}function Va(t){return new rt(t)}function To(t,e){t._reader._readIntoRequests.push(e)}function Ka(t){return t._reader._readIntoRequests.length}function Us(t){const e=t._reader;return e!==void 0&&!!st(e)}Object.defineProperties(De.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),x(De.prototype.close,"close"),x(De.prototype.enqueue,"enqueue"),x(De.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(De.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class rt{constructor(e){if(Et(e,1,"ReadableStreamBYOBReader"),Ws(e,"First parameter"),Ke(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!tt(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");wa(this,e),this._readIntoRequests=new se}get closed(){return st(this)?this._closedPromise:y(xn("closed"))}cancel(e=void 0){return st(this)?this._ownerReadableStream===void 0?y(Zn("cancel")):qs(this,e):y(xn("cancel"))}read(e,r={}){if(!st(this))return y(xn("read"));if(!ArrayBuffer.isView(e))return y(new TypeError("view must be an array buffer view"));if(e.byteLength===0)return y(new TypeError("view must have non-zero byteLength"));if(e.buffer.byteLength===0)return y(new TypeError("view's buffer must have non-zero byteLength"));if(Rt(e.buffer))return y(new TypeError("view's buffer has been detached"));let n;try{n=function(c,u){var h;return Ie(c,u),{min:Ds((h=c?.min)!==null&&h!==void 0?h:1,`${u} has member 'min' that`)}}(r,"options")}catch(c){return y(c)}const i=n.min;if(i===0)return y(new TypeError("options.min must be greater than 0"));if(function(c){return Aa(c.constructor)}(e)){if(i>e.byteLength)return y(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(i>e.length)return y(new RangeError("options.min must be less than or equal to view's length"));if(this._ownerReadableStream===void 0)return y(Zn("read from"));let s,o;const a=W((c,u)=>{s=c,o=u});return Ya(this,e,i,{_chunkSteps:c=>s({value:c,done:!1}),_closeSteps:c=>s({value:c,done:!0}),_errorSteps:c=>o(c)}),a}releaseLock(){if(!st(this))throw xn("releaseLock");this._ownerReadableStream!==void 0&&function(e){Ce(e);const r=new TypeError("Reader was released");Ha(e,r)}(this)}}function st(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readIntoRequests")&&t instanceof rt}function Ya(t,e,r,n){const i=t._ownerReadableStream;i._disturbed=!0,i._state==="errored"?n._errorSteps(i._storedError):Eu(i._readableStreamController,e,r,n)}function Ha(t,e){const r=t._readIntoRequests;t._readIntoRequests=new se,r.forEach(n=>{n._errorSteps(e)})}function xn(t){return new TypeError(`ReadableStreamBYOBReader.prototype.${t} can only be used on a ReadableStreamBYOBReader`)}function _r(t,e){const{highWaterMark:r}=t;if(r===void 0)return e;if(Ia(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Qn(t){const{size:e}=t;return e||(()=>1)}function Jn(t,e){Ie(t,e);const r=t?.highWaterMark,n=t?.size;return{highWaterMark:r===void 0?void 0:va(r),size:n===void 0?void 0:Ru(n,`${e} has member 'size' that`)}}function Ru(t,e){return oe(t,e),r=>va(t(r))}function Pu(t,e,r){return oe(t,r),n=>Be(t,e,[n])}function ku(t,e,r){return oe(t,r),()=>Be(t,e,[])}function xu(t,e,r){return oe(t,r),n=>St(t,e,[n])}function zu(t,e,r){return oe(t,r),(n,i)=>Be(t,e,[n,i])}function Ga(t,e){if(!Dt(t))throw new TypeError(`${e} is not a WritableStream.`)}Object.defineProperties(rt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),x(rt.prototype.cancel,"cancel"),x(rt.prototype.read,"read"),x(rt.prototype.releaseLock,"releaseLock"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(rt.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});let We=class{constructor(e={},r={}){e===void 0?e=null:_a(e,"First parameter");const n=Jn(r,"Second parameter"),i=function(o,a){Ie(o,a);const c=o?.abort,u=o?.close,h=o?.start,m=o?.type,p=o?.write;return{abort:c===void 0?void 0:Pu(c,o,`${a} has member 'abort' that`),close:u===void 0?void 0:ku(u,o,`${a} has member 'close' that`),start:h===void 0?void 0:xu(h,o,`${a} has member 'start' that`),write:p===void 0?void 0:zu(p,o,`${a} has member 'write' that`),type:m}}(e,"First parameter");if(Za(this),i.type!==void 0)throw new RangeError("Invalid type is specified");const s=Qn(n);(function(o,a,c,u){const h=Object.create(vr.prototype);let m,p,g,T;m=a.start!==void 0?()=>a.start(h):()=>{},p=a.write!==void 0?I=>a.write(I,h):()=>z(void 0),g=a.close!==void 0?()=>a.close():()=>z(void 0),T=a.abort!==void 0?I=>a.abort(I):()=>z(void 0),il(o,h,m,p,g,T,c,u)})(this,i,_r(n,1),s)}get locked(){if(!Dt(this))throw Cn("locked");return Mt(this)}abort(e=void 0){return Dt(this)?Mt(this)?y(new TypeError("Cannot abort a stream that already has a writer")):ei(this,e):y(Cn("abort"))}close(){return Dt(this)?Mt(this)?y(new TypeError("Cannot close a stream that already has a writer")):we(this)?y(new TypeError("Cannot close an already-closing stream")):Qa(this):y(Cn("close"))}getWriter(){if(!Dt(this))throw Cn("getWriter");return Xa(this)}};function Xa(t){return new Oe(t)}function Za(t){t._state="writable",t._storedError=void 0,t._writer=void 0,t._writableStreamController=void 0,t._writeRequests=new se,t._inFlightWriteRequest=void 0,t._closeRequest=void 0,t._inFlightCloseRequest=void 0,t._pendingAbortRequest=void 0,t._backpressure=!1}function Dt(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_writableStreamController")&&t instanceof We}function Mt(t){return t._writer!==void 0}function ei(t,e){var r;if(t._state==="closed"||t._state==="errored")return z(void 0);t._writableStreamController._abortReason=e,(r=t._writableStreamController._abortController)===null||r===void 0||r.abort(e);const n=t._state;if(n==="closed"||n==="errored")return z(void 0);if(t._pendingAbortRequest!==void 0)return t._pendingAbortRequest._promise;let i=!1;n==="erroring"&&(i=!0,e=void 0);const s=W((o,a)=>{t._pendingAbortRequest={_promise:void 0,_resolve:o,_reject:a,_reason:e,_wasAlreadyErroring:i}});return t._pendingAbortRequest._promise=s,i||Fs(t,e),s}function Qa(t){const e=t._state;if(e==="closed"||e==="errored")return y(new TypeError(`The stream (in ${e} state) is not in the writable state and cannot be closed`));const r=W((s,o)=>{const a={_resolve:s,_reject:o};t._closeRequest=a}),n=t._writer;var i;return n!==void 0&&t._backpressure&&e==="writable"&&Hs(n),js(i=t._writableStreamController,nl,0),Ei(i),r}function fs(t,e){t._state!=="writable"?Ms(t):Fs(t,e)}function Fs(t,e){const r=t._writableStreamController;t._state="erroring",t._storedError=e;const n=t._writer;n!==void 0&&el(n,e),!function(i){return!(i._inFlightWriteRequest===void 0&&i._inFlightCloseRequest===void 0)}(t)&&r._started&&Ms(t)}function Ms(t){t._state="errored",t._writableStreamController[ma]();const e=t._storedError;if(t._writeRequests.forEach(n=>{n._reject(e)}),t._writeRequests=new se,t._pendingAbortRequest===void 0)return void zn(t);const r=t._pendingAbortRequest;if(t._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(e),void zn(t);Q(t._writableStreamController[ba](r._reason),()=>(r._resolve(),zn(t),null),n=>(r._reject(n),zn(t),null))}function we(t){return t._closeRequest!==void 0||t._inFlightCloseRequest!==void 0}function zn(t){t._closeRequest!==void 0&&(t._closeRequest._reject(t._storedError),t._closeRequest=void 0);const e=t._writer;e!==void 0&&Ys(e,t._storedError)}function Vs(t,e){const r=t._writer;r!==void 0&&e!==t._backpressure&&(e?function(n){Ti(n)}(r):Hs(r)),t._backpressure=e}Object.defineProperties(We.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),x(We.prototype.abort,"abort"),x(We.prototype.close,"close"),x(We.prototype.getWriter,"getWriter"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(We.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});class Oe{constructor(e){if(Et(e,1,"WritableStreamDefaultWriter"),Ga(e,"First parameter"),Mt(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const r=e._state;if(r==="writable")!we(e)&&e._backpressure?Ti(this):Ro(this),jn(this);else if(r==="erroring")ps(this,e._storedError),jn(this);else if(r==="closed")Ro(this),jn(n=this),ll(n);else{const i=e._storedError;ps(this,i),al(this,i)}var n}get closed(){return Ze(this)?this._closedPromise:y(Qe("closed"))}get desiredSize(){if(!Ze(this))throw Qe("desiredSize");if(this._ownerWritableStream===void 0)throw pr("desiredSize");return function(e){const r=e._ownerWritableStream,n=r._state;return n==="errored"||n==="erroring"?null:n==="closed"?0:sl(r._writableStreamController)}(this)}get ready(){return Ze(this)?this._readyPromise:y(Qe("ready"))}abort(e=void 0){return Ze(this)?this._ownerWritableStream===void 0?y(pr("abort")):function(r,n){return ei(r._ownerWritableStream,n)}(this,e):y(Qe("abort"))}close(){if(!Ze(this))return y(Qe("close"));const e=this._ownerWritableStream;return e===void 0?y(pr("close")):we(e)?y(new TypeError("Cannot close an already-closing stream")):Ja(this)}releaseLock(){if(!Ze(this))throw Qe("releaseLock");this._ownerWritableStream!==void 0&&tl(this)}write(e=void 0){return Ze(this)?this._ownerWritableStream===void 0?y(pr("write to")):rl(this,e):y(Qe("write"))}}function Ze(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_ownerWritableStream")&&t instanceof Oe}function Ja(t){return Qa(t._ownerWritableStream)}function Cu(t,e){t._closedPromiseState==="pending"?Ys(t,e):function(r,n){al(r,n)}(t,e)}function el(t,e){t._readyPromiseState==="pending"?cl(t,e):function(r,n){ps(r,n)}(t,e)}function tl(t){const e=t._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");el(t,r),Cu(t,r),e._writer=void 0,t._ownerWritableStream=void 0}function rl(t,e){const r=t._ownerWritableStream,n=r._writableStreamController,i=function(a,c){if(a._strategySizeAlgorithm===void 0)return 1;try{return a._strategySizeAlgorithm(c)}catch(u){return Sr(a,u),1}}(n,e);if(r!==t._ownerWritableStream)return y(pr("write to"));const s=r._state;if(s==="errored")return y(r._storedError);if(we(r)||s==="closed")return y(new TypeError("The stream is closing or closed and cannot be written to"));if(s==="erroring")return y(r._storedError);const o=function(a){return W((c,u)=>{const h={_resolve:c,_reject:u};a._writeRequests.push(h)})}(r);return function(a,c,u){try{js(a,c,u)}catch(m){return void Sr(a,m)}const h=a._controlledWritableStream;!we(h)&&h._state==="writable"&&Vs(h,Ks(a)),Ei(a)}(n,e,i),o}Object.defineProperties(Oe.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),x(Oe.prototype.abort,"abort"),x(Oe.prototype.close,"close"),x(Oe.prototype.releaseLock,"releaseLock"),x(Oe.prototype.write,"write"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Oe.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const nl={};class vr{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Di(this))throw Wi("abortReason");return this._abortReason}get signal(){if(!Di(this))throw Wi("signal");if(this._abortController===void 0)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e=void 0){if(!Di(this))throw Wi("error");this._controlledWritableStream._state==="writable"&&ol(this,e)}[ba](e){const r=this._abortAlgorithm(e);return ti(this),r}[ma](){Xe(this)}}function Di(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledWritableStream")&&t instanceof vr}function il(t,e,r,n,i,s,o,a){e._controlledWritableStream=t,t._writableStreamController=e,e._queue=void 0,e._queueTotalSize=void 0,Xe(e),e._abortReason=void 0,e._abortController=function(){if(typeof AbortController=="function")return new AbortController}(),e._started=!1,e._strategySizeAlgorithm=a,e._strategyHWM=o,e._writeAlgorithm=n,e._closeAlgorithm=i,e._abortAlgorithm=s;const c=Ks(e);Vs(t,c),Q(z(r()),()=>(e._started=!0,Ei(e),null),u=>(e._started=!0,fs(t,u),null))}function ti(t){t._writeAlgorithm=void 0,t._closeAlgorithm=void 0,t._abortAlgorithm=void 0,t._strategySizeAlgorithm=void 0}function sl(t){return t._strategyHWM-t._queueTotalSize}function Ei(t){const e=t._controlledWritableStream;if(!t._started||e._inFlightWriteRequest!==void 0)return;if(e._state==="erroring")return void Ms(e);if(t._queue.length===0)return;const r=t._queue.peek().value;r===nl?function(n){const i=n._controlledWritableStream;(function(o){o._inFlightCloseRequest=o._closeRequest,o._closeRequest=void 0})(i),us(n);const s=n._closeAlgorithm();ti(n),Q(s,()=>(function(o){o._inFlightCloseRequest._resolve(void 0),o._inFlightCloseRequest=void 0,o._state==="erroring"&&(o._storedError=void 0,o._pendingAbortRequest!==void 0&&(o._pendingAbortRequest._resolve(),o._pendingAbortRequest=void 0)),o._state="closed";const a=o._writer;a!==void 0&&ll(a)}(i),null),o=>(function(a,c){a._inFlightCloseRequest._reject(c),a._inFlightCloseRequest=void 0,a._pendingAbortRequest!==void 0&&(a._pendingAbortRequest._reject(c),a._pendingAbortRequest=void 0),fs(a,c)}(i,o),null))}(t):function(n,i){const s=n._controlledWritableStream;(function(a){a._inFlightWriteRequest=a._writeRequests.shift()})(s);const o=n._writeAlgorithm(i);Q(o,()=>{(function(c){c._inFlightWriteRequest._resolve(void 0),c._inFlightWriteRequest=void 0})(s);const a=s._state;if(us(n),!we(s)&&a==="writable"){const c=Ks(n);Vs(s,c)}return Ei(n),null},a=>(s._state==="writable"&&ti(n),function(c,u){c._inFlightWriteRequest._reject(u),c._inFlightWriteRequest=void 0,fs(c,u)}(s,a),null))}(t,r)}function Sr(t,e){t._controlledWritableStream._state==="writable"&&ol(t,e)}function Ks(t){return sl(t)<=0}function ol(t,e){const r=t._controlledWritableStream;ti(t),Fs(r,e)}function Cn(t){return new TypeError(`WritableStream.prototype.${t} can only be used on a WritableStream`)}function Wi(t){return new TypeError(`WritableStreamDefaultController.prototype.${t} can only be used on a WritableStreamDefaultController`)}function Qe(t){return new TypeError(`WritableStreamDefaultWriter.prototype.${t} can only be used on a WritableStreamDefaultWriter`)}function pr(t){return new TypeError("Cannot "+t+" a stream using a released writer")}function jn(t){t._closedPromise=W((e,r)=>{t._closedPromise_resolve=e,t._closedPromise_reject=r,t._closedPromiseState="pending"})}function al(t,e){jn(t),Ys(t,e)}function Ys(t,e){t._closedPromise_reject!==void 0&&(lr(t._closedPromise),t._closedPromise_reject(e),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="rejected")}function ll(t){t._closedPromise_resolve!==void 0&&(t._closedPromise_resolve(void 0),t._closedPromise_resolve=void 0,t._closedPromise_reject=void 0,t._closedPromiseState="resolved")}function Ti(t){t._readyPromise=W((e,r)=>{t._readyPromise_resolve=e,t._readyPromise_reject=r}),t._readyPromiseState="pending"}function ps(t,e){Ti(t),cl(t,e)}function Ro(t){Ti(t),Hs(t)}function cl(t,e){t._readyPromise_reject!==void 0&&(lr(t._readyPromise),t._readyPromise_reject(e),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="rejected")}function Hs(t){t._readyPromise_resolve!==void 0&&(t._readyPromise_resolve(void 0),t._readyPromise_resolve=void 0,t._readyPromise_reject=void 0,t._readyPromiseState="fulfilled")}Object.defineProperties(vr.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(vr.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const Po=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:void 0,Iu=function(){const t=Po?.DOMException;return function(e){if(typeof e!="function"&&typeof e!="object"||e.name!=="DOMException")return!1;try{return new e,!0}catch{return!1}}(t)?t:void 0}()||function(){const t=function(e,r){this.message=e||"",this.name=r||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return x(t,"DOMException"),t.prototype=Object.create(Error.prototype),Object.defineProperty(t.prototype,"constructor",{value:t,writable:!0,configurable:!0}),t}();function ko(t,e,r,n,i,s){const o=Ut(t),a=Xa(e);t._disturbed=!0;let c=!1,u=z(void 0);return W((h,m)=>{let p;if(s!==void 0){if(p=()=>{const E=s.reason!==void 0?s.reason:new Iu("Aborted","AbortError"),B=[];n||B.push(()=>e._state==="writable"?ei(e,E):z(void 0)),i||B.push(()=>t._state==="readable"?he(t,E):z(void 0)),w(()=>Promise.all(B.map(P=>P())),!0,E)},s.aborted)return void p();s.addEventListener("abort",p)}var g,T,I;if(C(t,o._closedPromise,E=>(n?R(!0,E):w(()=>ei(e,E),!0,E),null)),C(e,a._closedPromise,E=>(i?R(!0,E):w(()=>he(t,E),!0,E),null)),g=t,T=o._closedPromise,I=()=>(r?R():w(()=>function(E){const B=E._ownerWritableStream,P=B._state;return we(B)||P==="closed"?z(void 0):P==="errored"?y(B._storedError):Ja(E)}(a)),null),g._state==="closed"?I():Ii(T,I),we(e)||e._state==="closed"){const E=new TypeError("the destination writable stream closed before all data could be piped to it");i?R(!0,E):w(()=>he(t,E),!0,E)}function q(){const E=u;return me(u,()=>E!==u?q():void 0)}function C(E,B,P){E._state==="errored"?P(E._storedError):ls(B,P)}function w(E,B,P){function k(){return Q(E(),()=>D(B,P),v=>D(!0,v)),null}c||(c=!0,e._state!=="writable"||we(e)?k():Ii(q(),k))}function R(E,B){c||(c=!0,e._state!=="writable"||we(e)?D(E,B):Ii(q(),()=>D(E,B)))}function D(E,B){return tl(a),Ce(o),s!==void 0&&s.removeEventListener("abort",p),E?m(B):h(void 0),null}lr(W((E,B)=>{(function P(k){k?E():me(c?z(!0):me(a._readyPromise,()=>W((v,A)=>{gr(o,{_chunkSteps:S=>{u=me(rl(a,S),void 0,yr),v(!1)},_closeSteps:()=>v(!0),_errorSteps:A})})),P,B)})(!1)}))})}class Ne{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!In(this))throw An("desiredSize");return Gs(this)}close(){if(!In(this))throw An("close");if(!ar(this))throw new TypeError("The stream is not in a state that permits close");Pt(this)}enqueue(e=void 0){if(!In(this))throw An("enqueue");if(!ar(this))throw new TypeError("The stream is not in a state that permits enqueue");return or(this,e)}error(e=void 0){if(!In(this))throw An("error");fe(this,e)}[As](e){Xe(this);const r=this._cancelAlgorithm(e);return ri(this),r}[Ls](e){const r=this._controlledReadableStream;if(this._queue.length>0){const n=us(this);this._closeRequested&&this._queue.length===0?(ri(this),Tn(r)):Er(this),e._chunkSteps(n)}else Sa(r,e),Er(this)}[Bs](){}}function In(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledReadableStream")&&t instanceof Ne}function Er(t){if(ul(t)){if(t._pulling)return void(t._pullAgain=!0);t._pulling=!0,Q(t._pullAlgorithm(),()=>(t._pulling=!1,t._pullAgain&&(t._pullAgain=!1,Er(t)),null),e=>(fe(t,e),null))}}function ul(t){const e=t._controlledReadableStream;return!ar(t)||!t._started?!1:Ke(e)&&vi(e)>0?!0:Gs(t)>0}function ri(t){t._pullAlgorithm=void 0,t._cancelAlgorithm=void 0,t._strategySizeAlgorithm=void 0}function Pt(t){if(!ar(t))return;const e=t._controlledReadableStream;t._closeRequested=!0,t._queue.length===0&&(ri(t),Tn(e))}function or(t,e){if(!ar(t))return;const r=t._controlledReadableStream;if(Ke(r)&&vi(r)>0)Ns(r,e,!1);else{let n;try{n=t._strategySizeAlgorithm(e)}catch(i){throw fe(t,i),i}try{js(t,e,n)}catch(i){throw fe(t,i),i}}Er(t)}function fe(t,e){const r=t._controlledReadableStream;r._state==="readable"&&(Xe(t),ri(t),hl(r,e))}function Gs(t){const e=t._controlledReadableStream._state;return e==="errored"?null:e==="closed"?0:t._strategyHWM-t._queueTotalSize}function ar(t){const e=t._controlledReadableStream._state;return!t._closeRequested&&e==="readable"}function dl(t,e,r,n,i,s,o){e._controlledReadableStream=t,e._queue=void 0,e._queueTotalSize=void 0,Xe(e),e._started=!1,e._closeRequested=!1,e._pullAgain=!1,e._pulling=!1,e._strategySizeAlgorithm=o,e._strategyHWM=s,e._pullAlgorithm=n,e._cancelAlgorithm=i,t._readableStreamController=e,Q(z(r()),()=>(e._started=!0,Er(e),null),a=>(fe(e,a),null))}function An(t){return new TypeError(`ReadableStreamDefaultController.prototype.${t} can only be used on a ReadableStreamDefaultController`)}function Au(t,e){return tt(t._readableStreamController)?function(r){let n,i,s,o,a,c=Ut(r),u=!1,h=!1,m=!1,p=!1,g=!1;const T=W(P=>{a=P});function I(P){ls(P._closedPromise,k=>(P!==c||(ne(s._readableStreamController,k),ne(o._readableStreamController,k),p&&g||a(void 0)),null))}function q(){st(c)&&(Ce(c),c=Ut(r),I(c)),gr(c,{_chunkSteps:P=>{vt(()=>{h=!1,m=!1;const k=P;let v=P;if(!p&&!g)try{v=Eo(P)}catch(A){return ne(s._readableStreamController,A),ne(o._readableStreamController,A),void a(he(r,A))}p||Dn(s._readableStreamController,k),g||Dn(o._readableStreamController,v),u=!1,h?w():m&&R()})},_closeSteps:()=>{u=!1,p||fr(s._readableStreamController),g||fr(o._readableStreamController),s._readableStreamController._pendingPullIntos.length>0&&Wn(s._readableStreamController,0),o._readableStreamController._pendingPullIntos.length>0&&Wn(o._readableStreamController,0),p&&g||a(void 0)},_errorSteps:()=>{u=!1}})}function C(P,k){Ve(c)&&(Ce(c),c=Va(r),I(c));const v=k?o:s,A=k?s:o;Ya(c,P,1,{_chunkSteps:S=>{vt(()=>{h=!1,m=!1;const L=k?g:p;if(k?p:g)L||Nn(v._readableStreamController,S);else{let X;try{X=Eo(S)}catch(M){return ne(v._readableStreamController,M),ne(A._readableStreamController,M),void a(he(r,M))}L||Nn(v._readableStreamController,S),Dn(A._readableStreamController,X)}u=!1,h?w():m&&R()})},_closeSteps:S=>{u=!1;const L=k?g:p,X=k?p:g;L||fr(v._readableStreamController),X||fr(A._readableStreamController),S!==void 0&&(L||Nn(v._readableStreamController,S),!X&&A._readableStreamController._pendingPullIntos.length>0&&Wn(A._readableStreamController,0)),L&&X||a(void 0)},_errorSteps:()=>{u=!1}})}function w(){if(u)return h=!0,z(void 0);u=!0;const P=hs(s._readableStreamController);return P===null?q():C(P._view,!1),z(void 0)}function R(){if(u)return m=!0,z(void 0);u=!0;const P=hs(o._readableStreamController);return P===null?q():C(P._view,!0),z(void 0)}function D(P){if(p=!0,n=P,g){const k=dr([n,i]),v=he(r,k);a(v)}return T}function E(P){if(g=!0,i=P,p){const k=dr([n,i]),v=he(r,k);a(v)}return T}function B(){}return s=zo(B,w,D),o=zo(B,R,E),I(c),[s,o]}(t):function(r){const n=Ut(r);let i,s,o,a,c,u=!1,h=!1,m=!1,p=!1;const g=W(w=>{c=w});function T(){return u?(h=!0,z(void 0)):(u=!0,gr(n,{_chunkSteps:w=>{vt(()=>{h=!1;const R=w,D=w;m||or(o._readableStreamController,R),p||or(a._readableStreamController,D),u=!1,h&&T()})},_closeSteps:()=>{u=!1,m||Pt(o._readableStreamController),p||Pt(a._readableStreamController),m&&p||c(void 0)},_errorSteps:()=>{u=!1}}),z(void 0))}function I(w){if(m=!0,i=w,p){const R=dr([i,s]),D=he(r,R);c(D)}return g}function q(w){if(p=!0,s=w,m){const R=dr([i,s]),D=he(r,R);c(D)}return g}function C(){}return o=Tr(C,T,I),a=Tr(C,T,q),ls(n._closedPromise,w=>(fe(o._readableStreamController,w),fe(a._readableStreamController,w),m&&p||c(void 0),null)),[o,a]}(t)}function Lu(t){return $(e=t)&&e.getReader!==void 0?function(r){let n;function i(){let o;try{o=r.read()}catch(a){return y(a)}return Ae(o,a=>{if(!$(a))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(a.done)Pt(n._readableStreamController);else{const c=a.value;or(n._readableStreamController,c)}})}function s(o){try{return z(r.cancel(o))}catch(a){return y(a)}}return n=Tr(yr,i,s,0),n}(t.getReader()):function(r){let n;const i=ka(r,"async");function s(){let a;try{a=xa(i)}catch(c){return y(c)}return Ae(z(a),c=>{if(!$(c))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(c.done)Pt(n._readableStreamController);else{const u=c.value;or(n._readableStreamController,u)}})}function o(a){const c=i.iterator;let u;try{u=hr(c,"return")}catch(h){return y(h)}return u===void 0?z(void 0):Ae(Be(u,c,[a]),h=>{if(!$(h))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})}return n=Tr(yr,s,o,0),n}(t);var e}function Bu(t,e,r){return oe(t,r),n=>Be(t,e,[n])}function qu(t,e,r){return oe(t,r),n=>Be(t,e,[n])}function Ou(t,e,r){return oe(t,r),n=>St(t,e,[n])}function Du(t,e){if((t=`${t}`)!="bytes")throw new TypeError(`${e} '${t}' is not a valid enumeration value for ReadableStreamType`);return t}function xo(t,e){Ie(t,e);const r=t?.preventAbort,n=t?.preventCancel,i=t?.preventClose,s=t?.signal;return s!==void 0&&function(o,a){if(!function(c){if(typeof c!="object"||c===null)return!1;try{return typeof c.aborted=="boolean"}catch{return!1}}(o))throw new TypeError(`${a} is not an AbortSignal.`)}(s,`${e} has member 'signal' that`),{preventAbort:!!r,preventCancel:!!n,preventClose:!!i,signal:s}}Object.defineProperties(Ne.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),x(Ne.prototype.close,"close"),x(Ne.prototype.enqueue,"enqueue"),x(Ne.prototype.error,"error"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(Ne.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});let V=class{constructor(e={},r={}){e===void 0?e=null:_a(e,"First parameter");const n=Jn(r,"Second parameter"),i=function(s,o){Ie(s,o);const a=s,c=a?.autoAllocateChunkSize,u=a?.cancel,h=a?.pull,m=a?.start,p=a?.type;return{autoAllocateChunkSize:c===void 0?void 0:Ds(c,`${o} has member 'autoAllocateChunkSize' that`),cancel:u===void 0?void 0:Bu(u,a,`${o} has member 'cancel' that`),pull:h===void 0?void 0:qu(h,a,`${o} has member 'pull' that`),start:m===void 0?void 0:Ou(m,a,`${o} has member 'start' that`),type:p===void 0?void 0:Du(p,`${o} has member 'type' that`)}}(e,"First parameter");if(Xs(this),i.type==="bytes"){if(n.size!==void 0)throw new RangeError("The strategy for a byte stream cannot have a size function");(function(s,o,a){const c=Object.create(De.prototype);let u,h,m;u=o.start!==void 0?()=>o.start(c):()=>{},h=o.pull!==void 0?()=>o.pull(c):()=>z(void 0),m=o.cancel!==void 0?g=>o.cancel(g):()=>z(void 0);const p=o.autoAllocateChunkSize;if(p===0)throw new TypeError("autoAllocateChunkSize must be greater than 0");Ma(s,c,u,h,m,a,p)})(this,i,_r(n,0))}else{const s=Qn(n);(function(o,a,c,u){const h=Object.create(Ne.prototype);let m,p,g;m=a.start!==void 0?()=>a.start(h):()=>{},p=a.pull!==void 0?()=>a.pull(h):()=>z(void 0),g=a.cancel!==void 0?T=>a.cancel(T):()=>z(void 0),dl(o,h,m,p,g,c,u)})(this,i,_r(n,1),s)}}get locked(){if(!qe(this))throw Je("locked");return Ke(this)}cancel(e=void 0){return qe(this)?Ke(this)?y(new TypeError("Cannot cancel a stream that already has a reader")):he(this,e):y(Je("cancel"))}getReader(e=void 0){if(!qe(this))throw Je("getReader");return function(r,n){Ie(r,n);const i=r?.mode;return{mode:i===void 0?void 0:Tu(i,`${n} has member 'mode' that`)}}(e,"First parameter").mode===void 0?Ut(this):Va(this)}pipeThrough(e,r={}){if(!qe(this))throw Je("pipeThrough");Et(e,1,"pipeThrough");const n=function(s,o){Ie(s,o);const a=s?.readable;yo(a,"readable","ReadableWritablePair"),Ws(a,`${o} has member 'readable' that`);const c=s?.writable;return yo(c,"writable","ReadableWritablePair"),Ga(c,`${o} has member 'writable' that`),{readable:a,writable:c}}(e,"First parameter"),i=xo(r,"Second parameter");if(Ke(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Mt(n.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return lr(ko(this,n.writable,i.preventClose,i.preventAbort,i.preventCancel,i.signal)),n.readable}pipeTo(e,r={}){if(!qe(this))return y(Je("pipeTo"));if(e===void 0)return y("Parameter 1 is required in 'pipeTo'.");if(!Dt(e))return y(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let n;try{n=xo(r,"Second parameter")}catch(i){return y(i)}return Ke(this)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Mt(e)?y(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ko(this,e,n.preventClose,n.preventAbort,n.preventCancel,n.signal)}tee(){if(!qe(this))throw Je("tee");return dr(Au(this))}values(e=void 0){if(!qe(this))throw Je("values");return function(r,n){const i=Ut(r),s=new za(i,n),o=Object.create(Ca);return o._asyncIteratorImpl=s,o}(this,function(r,n){return Ie(r,n),{preventCancel:!!r?.preventCancel}}(e,"First parameter").preventCancel)}[En](e){return this.values(e)}static from(e){return Lu(e)}};function Tr(t,e,r,n=1,i=()=>1){const s=Object.create(V.prototype);return Xs(s),dl(s,Object.create(Ne.prototype),t,e,r,n,i),s}function zo(t,e,r){const n=Object.create(V.prototype);return Xs(n),Ma(n,Object.create(De.prototype),t,e,r,0,void 0),n}function Xs(t){t._state="readable",t._reader=void 0,t._storedError=void 0,t._disturbed=!1}function qe(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_readableStreamController")&&t instanceof V}function Ke(t){return t._reader!==void 0}function he(t,e){if(t._disturbed=!0,t._state==="closed")return z(void 0);if(t._state==="errored")return y(t._storedError);Tn(t);const r=t._reader;if(r!==void 0&&st(r)){const n=r._readIntoRequests;r._readIntoRequests=new se,n.forEach(i=>{i._closeSteps(void 0)})}return Ae(t._readableStreamController[As](e),yr)}function Tn(t){t._state="closed";const e=t._reader;if(e!==void 0&&(ga(e),Ve(e))){const r=e._readRequests;e._readRequests=new se,r.forEach(n=>{n._closeSteps()})}}function hl(t,e){t._state="errored",t._storedError=e;const r=t._reader;r!==void 0&&(Os(r,e),Ve(r)?Ta(r,e):Ha(r,e))}function Je(t){return new TypeError(`ReadableStream.prototype.${t} can only be used on a ReadableStream`)}Object.defineProperties(V,{from:{enumerable:!0}}),Object.defineProperties(V.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),x(V.from,"from"),x(V.prototype.cancel,"cancel"),x(V.prototype.getReader,"getReader"),x(V.prototype.pipeThrough,"pipeThrough"),x(V.prototype.pipeTo,"pipeTo"),x(V.prototype.tee,"tee"),x(V.prototype.values,"values"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(V.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(V.prototype,En,{value:V.prototype.values,writable:!0,configurable:!0});const Wu=t=>t.byteLength;x(Wu,"size");const Nu=()=>1;x(Nu,"size");function ju(t,e,r){return oe(t,r),n=>Be(t,e,[n])}function $u(t,e,r){return oe(t,r),n=>St(t,e,[n])}function Uu(t,e,r){return oe(t,r),(n,i)=>Be(t,e,[n,i])}function Fu(t,e,r){return oe(t,r),n=>Be(t,e,[n])}let ni=class{constructor(e={},r={},n={}){e===void 0&&(e=null);const i=Jn(r,"Second parameter"),s=Jn(n,"Third parameter"),o=function(p,g){Ie(p,g);const T=p?.cancel,I=p?.flush,q=p?.readableType,C=p?.start,w=p?.transform,R=p?.writableType;return{cancel:T===void 0?void 0:Fu(T,p,`${g} has member 'cancel' that`),flush:I===void 0?void 0:ju(I,p,`${g} has member 'flush' that`),readableType:q,start:C===void 0?void 0:$u(C,p,`${g} has member 'start' that`),transform:w===void 0?void 0:Uu(w,p,`${g} has member 'transform' that`),writableType:R}}(e,"First parameter");if(o.readableType!==void 0)throw new RangeError("Invalid readableType specified");if(o.writableType!==void 0)throw new RangeError("Invalid writableType specified");const a=_r(s,0),c=Qn(s),u=_r(i,1),h=Qn(i);let m;(function(p,g,T,I,q,C){function w(){return g}function R(k){return function(v,A){const S=v._transformStreamController;return v._backpressure?Ae(v._backpressureChangePromise,()=>{const L=v._writable;if(L._state==="erroring")throw L._storedError;return Io(S,A)}):Io(S,A)}(p,k)}function D(k){return function(v,A){const S=v._transformStreamController;if(S._finishPromise!==void 0)return S._finishPromise;const L=v._readable;S._finishPromise=W((M,ki)=>{S._finishPromise_resolve=M,S._finishPromise_reject=ki});const X=S._cancelAlgorithm(A);return $n(S),Q(X,()=>(L._state==="errored"?At(S,L._storedError):(fe(L._readableStreamController,A),Ni(S)),null),M=>(fe(L._readableStreamController,M),At(S,M),null)),S._finishPromise}(p,k)}function E(){return function(k){const v=k._transformStreamController;if(v._finishPromise!==void 0)return v._finishPromise;const A=k._readable;v._finishPromise=W((L,X)=>{v._finishPromise_resolve=L,v._finishPromise_reject=X});const S=v._flushAlgorithm();return $n(v),Q(S,()=>(A._state==="errored"?At(v,A._storedError):(Pt(A._readableStreamController),Ni(v)),null),L=>(fe(A._readableStreamController,L),At(v,L),null)),v._finishPromise}(p)}function B(){return function(k){return ii(k,!1),k._backpressureChangePromise}(p)}function P(k){return function(v,A){const S=v._transformStreamController;if(S._finishPromise!==void 0)return S._finishPromise;const L=v._writable;S._finishPromise=W((M,ki)=>{S._finishPromise_resolve=M,S._finishPromise_reject=ki});const X=S._cancelAlgorithm(A);return $n(S),Q(X,()=>(L._state==="errored"?At(S,L._storedError):(Sr(L._writableStreamController,A),bs(v),Ni(S)),null),M=>(Sr(L._writableStreamController,M),bs(v),At(S,M),null)),S._finishPromise}(p,k)}p._writable=function(k,v,A,S,L=1,X=()=>1){const M=Object.create(We.prototype);return Za(M),il(M,Object.create(vr.prototype),k,v,A,S,L,X),M}(w,R,E,D,T,I),p._readable=Tr(w,B,P,q,C),p._backpressure=void 0,p._backpressureChangePromise=void 0,p._backpressureChangePromise_resolve=void 0,ii(p,!0),p._transformStreamController=void 0})(this,W(p=>{m=p}),u,h,a,c),function(p,g){const T=Object.create(nt.prototype);let I,q,C;I=g.transform!==void 0?w=>g.transform(w,T):w=>{try{return pl(T,w),z(void 0)}catch(R){return y(R)}},q=g.flush!==void 0?()=>g.flush(T):()=>z(void 0),C=g.cancel!==void 0?w=>g.cancel(w):()=>z(void 0),function(w,R,D,E,B){R._controlledTransformStream=w,w._transformStreamController=R,R._transformAlgorithm=D,R._flushAlgorithm=E,R._cancelAlgorithm=B,R._finishPromise=void 0,R._finishPromise_resolve=void 0,R._finishPromise_reject=void 0}(p,T,I,q,C)}(this,o),o.start!==void 0?m(o.start(this._transformStreamController)):m(void 0)}get readable(){if(!Co(this))throw Ao("readable");return this._readable}get writable(){if(!Co(this))throw Ao("writable");return this._writable}};function Co(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_transformStreamController")&&t instanceof ni}function fl(t,e){fe(t._readable._readableStreamController,e),Zs(t,e)}function Zs(t,e){$n(t._transformStreamController),Sr(t._writable._writableStreamController,e),bs(t)}function bs(t){t._backpressure&&ii(t,!1)}function ii(t,e){t._backpressureChangePromise!==void 0&&t._backpressureChangePromise_resolve(),t._backpressureChangePromise=W(r=>{t._backpressureChangePromise_resolve=r}),t._backpressure=e}Object.defineProperties(ni.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(ni.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});class nt{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Ln(this))throw Bn("desiredSize");return Gs(this._controlledTransformStream._readable._readableStreamController)}enqueue(e=void 0){if(!Ln(this))throw Bn("enqueue");pl(this,e)}error(e=void 0){if(!Ln(this))throw Bn("error");var r;r=e,fl(this._controlledTransformStream,r)}terminate(){if(!Ln(this))throw Bn("terminate");(function(e){const r=e._controlledTransformStream;Pt(r._readable._readableStreamController);const n=new TypeError("TransformStream terminated");Zs(r,n)})(this)}}function Ln(t){return!!$(t)&&!!Object.prototype.hasOwnProperty.call(t,"_controlledTransformStream")&&t instanceof nt}function $n(t){t._transformAlgorithm=void 0,t._flushAlgorithm=void 0,t._cancelAlgorithm=void 0}function pl(t,e){const r=t._controlledTransformStream,n=r._readable._readableStreamController;if(!ar(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{or(n,e)}catch(s){throw Zs(r,s),r._readable._storedError}(function(s){return!ul(s)})(n)!==r._backpressure&&ii(r,!0)}function Io(t,e){return Ae(t._transformAlgorithm(e),void 0,r=>{throw fl(t._controlledTransformStream,r),r})}function Bn(t){return new TypeError(`TransformStreamDefaultController.prototype.${t} can only be used on a TransformStreamDefaultController`)}function Ni(t){t._finishPromise_resolve!==void 0&&(t._finishPromise_resolve(),t._finishPromise_resolve=void 0,t._finishPromise_reject=void 0)}function At(t,e){t._finishPromise_reject!==void 0&&(lr(t._finishPromise),t._finishPromise_reject(e),t._finishPromise_resolve=void 0,t._finishPromise_reject=void 0)}function Ao(t){return new TypeError(`TransformStream.prototype.${t} can only be used on a TransformStream`)}Object.defineProperties(nt.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),x(nt.prototype.enqueue,"enqueue"),x(nt.prototype.error,"error"),x(nt.prototype.terminate,"terminate"),typeof Symbol.toStringTag=="symbol"&&Object.defineProperty(nt.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});const Lt=globalThis;let Qs=V,Ri=We,bl=ni;Lt.ReadableStream&&Lt.WritableStream&&Lt.TransformStream&&(Qs=Lt.ReadableStream,Ri=Lt.WritableStream,bl=Lt.TransformStream);const{console:Lo}=globalThis,Mu=Lo.createTask?.bind(Lo)??(()=>({run(t){return t()}}));class ml{constructor(e){b(this,"task");b(this,"resolver");b(this,"value");b(this,"consumed");this.task=Mu("Consumable"),this.value=e,this.resolver=new fa,this.consumed=this.resolver.promise}consume(){this.resolver.resolve()}error(e){this.resolver.reject(e)}async tryConsume(e){try{const r=await this.task.run(()=>e(this.value));return this.consume(),r}catch(r){throw this.resolver.reject(r),r}}}async function Vu(t,e){const r=new ml(e);t.enqueue(r),await r.consumed}class Ku extends Ri{static async write(e,r){const n=new ml(r);await e.write(n),await n.consumed}constructor(e,r){let n;r&&(n={},"highWaterMark"in r&&(n.highWaterMark=r.highWaterMark),"size"in r&&(n.size=i=>r.size(i.value))),super({start(){return e.start?.()},async write(i){await i.tryConsume(s=>e.write?.(s)),i.consume()},abort(i){return e.abort?.(i)},close(){return e.close?.()}},n)}}class Yu extends bl{constructor(e){let r;super({async start(n){r={async enqueue(i){await Vu(n,i)},close(){n.terminate()},error(i){n.error(i)}},await e.start?.(r)},async transform(n){await n.tryConsume(i=>e.transform?.(i,r)),n.consume()},async flush(){await e.flush?.(r)}})}}class Js{constructor(e){b(this,"TValue");b(this,"TOmitInitKey");b(this,"options");this.options=e}}class kt{constructor(e,r,n,i){b(this,"definition");b(this,"options");b(this,"struct");b(this,"value");this.definition=e,this.options=r,this.struct=n,this.value=i}get hasCustomAccessors(){return this.get!==kt.prototype.get||this.set!==kt.prototype.set}getSize(){return this.definition.getSize()}get(){return this.value}set(e){this.value=e}}const Hu={littleEndian:!1},ms=Symbol("struct-value");class Bo{constructor(e){b(this,"fieldValues",{});b(this,"value");this.value=Object.create(e),Object.defineProperty(this.value,ms,{enumerable:!1,value:this})}set(e,r){this.fieldValues[e]=r,r.hasCustomAccessors?Object.defineProperty(this.value,e,{configurable:!0,enumerable:!0,get(){return r.get()},set(n){r.set(n)}}):this.value[e]=r.get()}get(e){return this.fieldValues[e]}}const He={reject(t){return new Oo(t)},resolve(t){return typeof t=="object"&&t!==null&&typeof t.then=="function"?t instanceof si||t instanceof qo||t instanceof Oo?t:new si(t):new qo(t)},try(t){try{return He.resolve(t())}catch(e){return He.reject(e)}}};class si{constructor(e){b(this,"promise");this.promise=e}then(e,r){return new si(this.promise.then(e,r))}valueOrPromise(){return this.promise}}class qo{constructor(e){b(this,"value");this.value=e}then(e){return e?He.try(()=>e(this.value)):this}valueOrPromise(){return this.value}}class Oo{constructor(e){b(this,"reason");this.reason=e}then(e,r){return r?He.try(()=>r(this.reason)):this}valueOrPromise(){throw this.reason}}const Pi=BigInt(32);function Gu(t,e,r){const n=+!!r,i=+!r;return BigInt(t.getInt32(e,r)*i+t.getInt32(e+4,r)*n)<<Pi|BigInt(t.getUint32(e,r)*n+t.getUint32(e+4,r)*i)}function Xu(t,e,r){const n=t.getUint32(e,r),i=t.getUint32(e+4,r),s=+!!r,o=+!r;return BigInt(n*o+i*s)<<Pi|BigInt(n*s+i*o)}function Zu(t,e,r,n){const i=Number(r>>Pi),s=Number(r&BigInt(4294967295));n?(t.setInt32(e+4,i,n),t.setUint32(e,s,n)):(t.setInt32(e,i,n),t.setUint32(e+4,s,n))}function Qu(t,e,r,n){const i=Number(r>>Pi),s=Number(r&BigInt(4294967295));n?(t.setUint32(e+4,i,n),t.setUint32(e,s,n)):(t.setUint32(e,i,n),t.setUint32(e+4,s,n))}const Ju="getBigInt64"in DataView.prototype?(t,e,r)=>t.getBigInt64(e,r):Gu,ed="getBigUint64"in DataView.prototype?(t,e,r)=>t.getBigUint64(e,r):Xu,td="setBigInt64"in DataView.prototype?(t,e,r,n)=>t.setBigInt64(e,r,n):Zu,rd="setBigUint64"in DataView.prototype?(t,e,r,n)=>t.setBigUint64(e,r,n):Qu,Nt=class Nt{constructor(e,r,n){b(this,"TTypeScriptType");b(this,"size");b(this,"getter");b(this,"setter");this.size=e,this.getter=r,this.setter=n}};b(Nt,"Int64",new Nt(8,Ju,td)),b(Nt,"Uint64",new Nt(8,ed,rd));let oi=Nt;class nd extends Js{constructor(r,n){super();b(this,"type");this.type=r}getSize(){return this.type.size}create(r,n,i){return new id(this,r,n,i)}deserialize(r,n,i){return He.try(()=>n.read(this.getSize())).then(s=>{const o=new DataView(s.buffer,s.byteOffset,s.byteLength),a=this.type.getter(o,0,r.littleEndian);return this.create(r,i,a)}).valueOrPromise()}}class id extends kt{serialize(e,r){this.definition.type.setter(e,r,this.value,this.options.littleEndian)}}const{TextEncoder:sd,TextDecoder:od}=globalThis,ad=new sd,ld=new od;function cd(t){return ad.encode(t)}function ud(t){return ld.decode(t)}class wl{constructor(){b(this,"TTypeScriptType")}}const pi=class pi extends wl{constructor(){super()}toBuffer(e){return e}toValue(e){return e}getSize(e){return e.byteLength}};b(pi,"Instance",new pi);let ws=pi;const bi=class bi extends wl{toBuffer(e){return cd(e)}toValue(e){return ud(e)}getSize(){return-1}};b(bi,"Instance",new bi);let ys=bi;const gs=new Uint8Array(0);class yl extends Js{constructor(r,n){super(n);b(this,"type");this.type=r}getDeserializeSize(r){return this.getSize()}create(r,n,i,s){return new gl(this,r,n,i,s)}deserialize(r,n,i){return He.try(()=>{const s=this.getDeserializeSize(i);return s===0?gs:n.read(s)}).then(s=>{const o=this.type.toValue(s);return this.create(r,i,o,s)}).valueOrPromise()}}class gl extends kt{constructor(r,n,i,s,o){super(r,n,i,s);b(this,"array");this.array=o}set(r){super.set(r),this.array=void 0}serialize(r,n){this.array||(this.array=this.definition.type.toBuffer(this.value)),new Uint8Array(r.buffer,r.byteOffset,r.byteLength).set(this.array,n)}}class dd extends yl{getSize(){return this.options.length}}class hd extends yl{getSize(){return 0}getDeserializeSize(e){let r=e.value[this.options.lengthField];return typeof r=="string"&&(r=Number.parseInt(r,this.options.lengthFieldRadix??10)),r}create(e,r,n,i){return new fd(this,e,r,n,i)}}class fd extends gl{constructor(r,n,i,s,o){super(r,n,i,s,o);b(this,"length");b(this,"lengthFieldValue");o&&(this.length=o.byteLength);const a=this.definition.options.lengthField,c=i.get(a);this.lengthFieldValue=new pd(c,this),i.set(a,this.lengthFieldValue)}getSize(){return this.length===void 0&&(this.length=this.definition.type.getSize(this.value),this.length===-1&&(this.array=this.definition.type.toBuffer(this.value),this.length=this.array.byteLength)),this.length}set(r){super.set(r),this.array=void 0,this.length=void 0}}class pd extends kt{constructor(r,n){super(r.definition,r.options,r.struct,0);b(this,"originalField");b(this,"bufferField");this.originalField=r,this.bufferField=n}getSize(){return this.originalField.getSize()}get(){let r=this.bufferField.getSize();return typeof this.originalField.get()=="string"&&(r=r.toString(this.bufferField.definition.options.lengthFieldRadix??10)),r}set(){}serialize(r,n){this.originalField.set(this.get()),this.originalField.serialize(r,n)}}var ve;(function(t){t.Uint8={signed:!1,size:1,deserialize(e){return e[0]},serialize(e,r,n){e.setUint8(r,n)}},t.Int8={signed:!0,size:1,deserialize(e){return t.Uint8.deserialize(e,!1)<<24>>24},serialize(e,r,n){e.setInt8(r,n)}},t.Uint16={signed:!1,size:2,deserialize(e,r){return(e[1]<<8|e[0])*r|(e[0]<<8|e[1])*!r},serialize(e,r,n,i){e.setUint16(r,n,i)}},t.Int16={signed:!0,size:2,deserialize(e,r){return t.Uint16.deserialize(e,r)<<16>>16},serialize(e,r,n,i){e.setInt16(r,n,i)}},t.Uint32={signed:!1,size:4,deserialize(e,r){return t.Int32.deserialize(e,r)>>>0},serialize(e,r,n,i){e.setUint32(r,n,i)}},t.Int32={signed:!0,size:4,deserialize(e,r){return(e[3]<<24|e[2]<<16|e[1]<<8|e[0])*r|(e[0]<<24|e[1]<<16|e[2]<<8|e[3])*!r},serialize(e,r,n,i){e.setInt32(r,n,i)}}})(ve=ve||(ve={}));class bd extends Js{constructor(r,n){super();b(this,"type");this.type=r}getSize(){return this.type.size}create(r,n,i){return new md(this,r,n,i)}deserialize(r,n,i){return He.try(()=>n.read(this.getSize())).then(s=>{const o=this.type.deserialize(s,r.littleEndian);return this.create(r,i,o)}).valueOrPromise()}}class md extends kt{serialize(e,r){this.definition.type.serialize(e,r,this.value,this.options.littleEndian)}}class F{constructor(e){b(this,"TFields");b(this,"TOmitInitKey");b(this,"TExtra");b(this,"TInit");b(this,"TDeserializeResult");b(this,"options");b(this,"_size",0);b(this,"_fields",[]);b(this,"_extra",{});b(this,"_postDeserialized");b(this,"arrayBufferLike",(e,r,n)=>"length"in n?this.field(e,new dd(r,n)):this.field(e,new hd(r,n)));b(this,"uint8Array",(e,r,n)=>this.arrayBufferLike(e,ws.Instance,r,n));b(this,"string",(e,r,n)=>this.arrayBufferLike(e,ys.Instance,r,n));this.options={...Hu,...e}}get size(){return this._size}field(e,r){for(const i of this._fields)if(i[0]===e)throw new Error(`This struct already have a field with name '${String(e)}'`);this._fields.push([e,r]);const n=r.getSize();return this._size+=n,this}fields(e){for(const r of e._fields)this._fields.push(r);return this._size+=e._size,Object.defineProperties(this._extra,Object.getOwnPropertyDescriptors(e._extra)),this}number(e,r,n){return this.field(e,new bd(r,n))}int8(e,r){return this.number(e,ve.Int8,r)}uint8(e,r){return this.number(e,ve.Uint8,r)}int16(e,r){return this.number(e,ve.Int16,r)}uint16(e,r){return this.number(e,ve.Uint16,r)}int32(e,r){return this.number(e,ve.Int32,r)}uint32(e,r){return this.number(e,ve.Uint32,r)}bigint(e,r,n){return this.field(e,new nd(r,n))}int64(e,r){return this.bigint(e,oi.Int64,r)}uint64(e,r){return this.bigint(e,oi.Uint64,r)}extra(e){return Object.defineProperties(this._extra,Object.getOwnPropertyDescriptors(e)),this}postDeserialize(e){return this._postDeserialized=e,this}deserialize(e){const r=new Bo(this._extra);let n=He.resolve();for(const[i,s]of this._fields)n=n.then(()=>s.deserialize(this.options,e,r)).then(o=>{r.set(i,o)});return n.then(()=>{const i=r.value;if(this._postDeserialized){const s=this._postDeserialized.call(i,i);if(s!==void 0)return s}return i}).valueOrPromise()}serialize(e,r){let n;if(ms in e){n=e[ms];for(const[u,h]of Object.entries(e)){const m=n.get(u);m&&m.set(h)}}else{n=new Bo({});for(const[u,h]of this._fields){const m=h.create(this.options,n,e[u]);n.set(u,m)}}let i=0;const s=[];for(const[u]of this._fields){const h=n.get(u),m=h.getSize();s.push({fieldValue:h,size:m}),i+=m}let o="number";r||(r=new Uint8Array(i),o="Uint8Array");const a=new DataView(r.buffer,r.byteOffset,r.byteLength);let c=0;for(const{fieldValue:u,size:h}of s)u.serialize(a,c),c+=h;return o==="number"?i:r}}function wd(t,e){return"start"in t?t.start(e):typeof t=="function"?t(e):t}class yd extends Qs{constructor(r){super({start:async n=>{await Promise.resolve(),this.readable=await wd(r,n),this.reader=this.readable.getReader()},cancel:async n=>{await this.reader.cancel(n),"cancel"in r&&await r.cancel?.(n)},pull:async n=>{const i=await this.reader.read();i.done?(n.close(),"close"in r&&await r.close?.()):n.enqueue(i.value)}});b(this,"readable");b(this,"reader")}}const Do=()=>{};class gd{constructor(e){b(this,"readableControllers",[]);b(this,"writers",[]);b(this,"_writableClosed",!1);b(this,"_closed",new fa);b(this,"options");this.options=e??{}}get writableClosed(){return this._writableClosed}get closed(){return this._closed.promise}wrapReadable(e){return new yd({start:r=>(this.readableControllers.push(r),e),cancel:async()=>{await this.close()},close:async()=>{await this.dispose()}})}createWritable(e){const r=e.getWriter();return this.writers.push(r),new Ri({write:async n=>{await r.write(n)},abort:async n=>{await r.abort(n),await this.close()},close:async()=>{await r.close().catch(Do),await this.close()}})}async close(){if(!this._writableClosed){this._writableClosed=!0,await this.options.close?.()!==!1&&await this.dispose();for(const e of this.writers)await e.close().catch(Do)}}async dispose(){this._writableClosed=!0,this._closed.resolve();for(const e of this.readableControllers)try{e.close()}catch{}await this.options.dispose?.()}}function _d(t,e){const r=e.writable.getWriter(),n=e.readable.pipeTo(t);return new Ri({async write(i){await r.write(i)},async close(){await r.close(),await n}})}BigInt(0);BigInt(1);BigInt(2);BigInt(64);var ji;(function(t){t[t.Auth=1213486401]="Auth",t[t.Close=1163086915]="Close",t[t.Connect=1314410051]="Connect",t[t.OK=1497451343]="OK",t[t.Open=1313165391]="Open",t[t.Write=1163154007]="Write"})(ji=ji||(ji={}));const ai=new F({littleEndian:!0}).uint32("command").uint32("arg0").uint32("arg1").uint32("payloadLength").uint32("checksum").int32("magic");new F({littleEndian:!0}).fields(ai).uint8Array("payload",{lengthField:"payloadLength"});class vd extends Yu{constructor(){const e=new Uint8Array(ai.size);super({transform:async(r,n)=>{const i=r;i.payloadLength=i.payload.byteLength,ai.serialize(i,e),await n.enqueue(e),i.payload.byteLength&&await n.enqueue(i.payload)}})}}function Rn(t,e){t.charCodeAt(0),e.charCodeAt(0)}Rn("A","Z");Rn("a","z");Rn("0","9");Rn("+","+");Rn("/","/");var $i;(function(t){t[t.Token=1]="Token",t[t.Signature=2]="Signature",t[t.PublicKey=3]="PublicKey"})($i=$i||($i={}));new F({littleEndian:!0}).uint32("version");new F({littleEndian:!0}).uint32("bpp").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").uint8Array("data",{lengthField:"size"});new F({littleEndian:!0}).uint32("bpp").uint32("colorSpace").uint32("size").uint32("width").uint32("height").uint32("red_offset").uint32("red_length").uint32("blue_offset").uint32("blue_length").uint32("green_offset").uint32("green_length").uint32("alpha_offset").uint32("alpha_length").uint8Array("data",{lengthField:"size"});const Sd=new F().string("length",{length:4}).string("content",{lengthField:"length",lengthFieldRadix:16});class eo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,eo.prototype)}}class to extends Error{constructor(){super("ADB reverse tunnel is not supported on this device when connected wirelessly."),Object.setPrototypeOf(this,to.prototype)}}new F().fields(Sd).postDeserialize(t=>{throw t.content==="more than one device/emulator"?new to:new eo(t.content)});var Ui;(function(t){t.ShellV2="shell_v2",t.Cmd="cmd",t.StatV2="stat_v2",t.ListV2="ls_v2",t.FixedPushMkdir="fixed_push_mkdir",t.Abb="abb",t.AbbExec="abb_exec",t.SendReceiveV2="sendrecv_v2"})(Ui=Ui||(Ui={}));var Fi;(function(t){t[t.Stdin=0]="Stdin",t[t.Stdout=1]="Stdout",t[t.Stderr=2]="Stderr",t[t.Exit=3]="Exit",t[t.CloseStdin=4]="CloseStdin",t[t.WindowSizeChange=5]="WindowSizeChange"})(Fi=Fi||(Fi={}));new F({littleEndian:!0}).uint8("id",void 0).uint32("length").uint8Array("data",{lengthField:"length"});var Mi;(function(t){t.List="LIST",t.ListV2="LIS2",t.Send="SEND",t.SendV2="SND2",t.Lstat="STAT",t.Stat="STA2",t.LstatV2="LST2",t.Data="DATA",t.Done="DONE",t.Receive="RECV"})(Mi=Mi||(Mi={}));const Ed=new F({littleEndian:!0}).string("id",{length:4}).uint32("arg");new F({littleEndian:!0}).fields(Ed).uint8Array("data",{lengthField:"arg"});var Ye;(function(t){t.Entry="DENT",t.Entry2="DNT2",t.Lstat="STAT",t.Stat="STA2",t.Lstat2="LST2",t.Done="DONE",t.Data="DATA",t.Ok="OKAY",t.Fail="FAIL"})(Ye=Ye||(Ye={}));new F({littleEndian:!0}).uint32("messageLength").string("message",{lengthField:"messageLength"}).postDeserialize(t=>{throw new Error(t.message)});var Vi;(function(t){t[t.Directory=4]="Directory",t[t.File=8]="File",t[t.Link=10]="Link"})(Vi=Vi||(Vi={}));const Td=new F({littleEndian:!0}).int32("mode").int32("size").int32("mtime").extra({id:Ye.Lstat,get type(){return this.mode>>12},get permission(){return this.mode&4095}}).postDeserialize(t=>{if(t.mode===0&&t.size===0&&t.mtime===0)throw new Error("lstat error")});var Un;(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.EACCES=13]="EACCES",t[t.EEXIST=17]="EEXIST",t[t.EFAULT=14]="EFAULT",t[t.EFBIG=27]="EFBIG",t[t.EINTR=4]="EINTR",t[t.EINVAL=22]="EINVAL",t[t.EIO=5]="EIO",t[t.EISDIR=21]="EISDIR",t[t.ELOOP=40]="ELOOP",t[t.EMFILE=24]="EMFILE",t[t.ENAMETOOLONG=36]="ENAMETOOLONG",t[t.ENFILE=23]="ENFILE",t[t.ENOENT=2]="ENOENT",t[t.ENOMEM=12]="ENOMEM",t[t.ENOSPC=28]="ENOSPC",t[t.ENOTDIR=20]="ENOTDIR",t[t.EOVERFLOW=75]="EOVERFLOW",t[t.EPERM=1]="EPERM",t[t.EROFS=30]="EROFS",t[t.ETXTBSY=26]="ETXTBSY"})(Un=Un||(Un={}));const Rd=new F({littleEndian:!0}).uint32("error",void 0).uint64("dev").uint64("ino").uint32("mode").uint32("nlink").uint32("uid").uint32("gid").uint64("size").uint64("atime").uint64("mtime").uint64("ctime").extra({id:Ye.Stat,get type(){return this.mode>>12},get permission(){return this.mode&4095}}).postDeserialize(t=>{if(t.error)throw new Error(Un[t.error])});new F({littleEndian:!0}).fields(Td).uint32("nameLength").string("name",{lengthField:"nameLength"}).extra({id:Ye.Entry});new F({littleEndian:!0}).fields(Rd).uint32("nameLength").string("name",{lengthField:"nameLength"}).extra({id:Ye.Entry2});new F({littleEndian:!0}).uint32("dataLength").uint8Array("data",{lengthField:"dataLength"}).extra({id:Ye.Data});new F({littleEndian:!0}).uint32("unused");var Ki;(function(t){t[t.None=0]="None",t[t.Brotli=1]="Brotli",t[t.Lz4=2]="Lz4",t[t.Zstd=4]="Zstd",t[t.DryRun=2147483648]="DryRun"})(Ki=Ki||(Ki={}));new F({littleEndian:!0}).uint32("id",void 0).uint32("mode").uint32("flags",void 0);var Yi;(function(t){t.Product="ro.product.name",t.Model="ro.product.model",t.Device="ro.product.device",t.Features="features"})(Yi=Yi||(Yi={}));const _s={classCode:255,subclassCode:66,protocolCode:1};function Pd(t,e){return e.some(r=>t.interfaceClass===r.classCode&&t.interfaceSubclass===r.subclassCode&&t.interfaceProtocol===r.protocolCode)}function kd(t,e){for(const r of t.configurations)for(const n of r.interfaces)for(const i of n.alternates)if(Pd(i,e))return{configuration:r,interface_:n,alternate:i};throw new Error("No matched alternate interface found")}function xd(t){if(t.length===0)throw new Error("No endpoints given");let e,r;for(const n of t)switch(n.direction){case"in":if(e=n,r)return{inEndpoint:e,outEndpoint:r};break;case"out":if(r=n,e)return{inEndpoint:e,outEndpoint:r};break}throw e?r?new Error("unreachable"):new Error("No output endpoint found."):new Error("No input endpoint found.")}class zd{constructor(e){b(this,"buffer");b(this,"offset");this.buffer=e,this.offset=0}read(e){const r=this.buffer.subarray(this.offset,this.offset+e);return this.offset+=e,r}}class Cd{constructor(e,r,n,i){b(this,"_readable");b(this,"_writable");let s=!1;const o=new gd({close:async()=>{try{s=!0,await e.close()}catch{}},dispose:()=>{i.removeEventListener("disconnect",a)}});function a(u){u.device===e&&o.dispose().catch(h=>{})}i.addEventListener("disconnect",a),this._readable=o.wrapReadable(new Qs({async pull(u){const h=await e.transferIn(r.endpointNumber,24),m=new Uint8Array(h.data.buffer),p=new zd(m),g=ai.deserialize(p);if(g.payloadLength!==0){const T=await e.transferIn(r.endpointNumber,g.payloadLength);g.payload=new Uint8Array(T.data.buffer)}else g.payload=gs;u.enqueue(g)}}));const c=n.packetSize-1;this._writable=_d(o.createWritable(new Ku({write:async u=>{try{await e.transferOut(n.endpointNumber,u),c&&!(u.byteLength&c)&&await e.transferOut(n.endpointNumber,gs)}catch(h){if(s)return;throw h}}})),new vd)}get readable(){return this._readable}get writable(){return this._writable}}class Wo{constructor(e,r=[_s],n){b(this,"_filters");b(this,"_usb");b(this,"_device");this._device=e,this._filters=r,this._usb=n}get device(){return this._device}get serial(){return this._device.serialNumber}get name(){return this._device.productName}async connect(){this._device.opened||await this._device.open();const{configuration:e,interface_:r,alternate:n}=kd(this._device,this._filters);this._device.configuration?.configurationValue!==e.configurationValue&&await this._device.selectConfiguration(e.configurationValue),r.claimed||await this._device.claimInterface(r.interfaceNumber),r.alternate.alternateSetting!==n.alternateSetting&&await this._device.selectAlternateInterface(r.interfaceNumber,n.alternateSetting);const{inEndpoint:i,outEndpoint:s}=xd(n.endpoints);return new Cd(this._device,i,s,this._usb)}}const mi=class mi{constructor(e){b(this,"_usb");this._usb=e}async requestDevice(e=[_s]){try{const r=await this._usb.requestDevice({filters:e});return new Wo(r,e,this._usb)}catch(r){if(typeof r=="object"&&r!==null&&"name"in r&&r.name==="NotFoundError")return;throw r}}async getDevices(e=[_s]){return(await this._usb.getDevices()).map(n=>new Wo(n,e,this._usb))}};b(mi,"BROWSER",typeof window<"u"&&window.navigator.usb?new mi(window.navigator.usb):void 0);let vs=mi;const Id="webusb-adb-keys",br="keys";function No(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=atob(e);return Uint8Array.from(r,n=>n.charCodeAt(0))}function Ad(t,e){const r=new Uint8Array(600),n=new Uint8Array(256);n.set(t.slice(-256),256-Math.min(t.length,256)),r.set(n,38);const i=new Uint8Array(256);return i.set(e.slice(-256),256-Math.min(e.length,256)),r.set(i,303),r}async function Ld(){return new Promise((t,e)=>{const r=indexedDB.open(Id,1);r.onupgradeneeded=()=>r.result.createObjectStore(br),r.onsuccess=()=>t(r.result),r.onerror=()=>e(r.error)})}async function Bd(){const t=await Ld(),e=await new Promise((a,c)=>{const h=t.transaction(br,"readonly").objectStore(br).get("adbkey");h.onsuccess=()=>a(h.result),h.onerror=()=>c(h.error)});if(e)return e;const r=await crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-1"},!0,["sign","verify"]),n=await crypto.subtle.exportKey("jwk",r.privateKey),i=No(n.n),s=No(n.d),o=Ad(i,s);return await new Promise((a,c)=>{const h=t.transaction(br,"readwrite").objectStore(br).put(o,"adbkey");h.onsuccess=()=>a(),h.onerror=()=>c(h.error)}),o}async function qd(){const e={buffer:await Bd(),name:"webusb-adb"};return{async*iterateKeys(){yield e},async generateKey(){return e}}}const mr=document.getElementById("btn-connect"),_l=document.getElementById("btn-disconnect"),Ss=document.getElementById("btn-run"),Od=document.getElementById("btn-clear"),Rr=document.getElementById("cmd-input"),Fn=document.getElementById("output"),li=document.getElementById("device-info"),Mn=document.getElementById("auth-prompt"),Dd=document.getElementById("status-dot"),Wd=document.getElementById("status-text"),Nd=document.getElementById("shell-section"),Vn=document.getElementById("error-banner"),jd=document.querySelectorAll(".btn-quick");let Le=null;function qt(t,e){Dd.className=`dot ${t?"connected":"disconnected"}`,Wd.textContent=e}function vl(t){Vn.textContent=` ${t}`,Vn.classList.remove("hidden"),setTimeout(()=>Vn.classList.add("hidden"),8e3)}function Wt(t){Fn.textContent+=t,Fn.scrollTop=Fn.scrollHeight}function Sl(t){mr.disabled=t,_l.disabled=!t,Nd.style.display=t?"block":"none",t||(li.innerHTML="",li.classList.add("hidden"),Mn.classList.add("hidden"))}mr.addEventListener("click",async()=>{mr.disabled=!0,qt(!1,"Requesting device"),Vn.classList.add("hidden");try{if(!navigator.usb)throw new Error("WebUSB is not supported in this browser. Use Chrome or Edge.");const t=await qd(),e=vs.BROWSER;if(!e)throw new Error("WebUSB not available  use Chrome or Edge.");const r=await e.requestDevice();if(!r){qt(!1,"Disconnected"),mr.disabled=!1;return}qt(!1,"Connecting"),Mn.classList.remove("hidden");const n=await r.connect(),i=await as.authenticate({serial:r.serial,connection:n,credentialStore:t});Mn.classList.add("hidden"),Le=new Zc(i);const s=await jo(Le,"ro.product.model")??"Unknown model",o=await jo(Le,"ro.build.version.release")??"?",a=i.serial;li.innerHTML=`
      <table>
        <tr><td>Serial</td><td><code>${Hi(a)}</code></td></tr>
        <tr><td>Model</td><td><code>${Hi(s)}</code></td></tr>
        <tr><td>Android</td><td><code>${Hi(o)}</code></td></tr>
      </table>`,li.classList.remove("hidden"),qt(!0,`Connected  ${s}`),Sl(!0),Wt(`# Connected to ${a} (${s}, Android ${o})
# Type a command above and press Run, or use the quick buttons.

`)}catch(t){const e=t instanceof Error?t.message:String(t);vl(e),console.error(t),qt(!1,"Connection failed"),Mn.classList.add("hidden"),mr.disabled=!1}});_l.addEventListener("click",async()=>{if(Le){try{await Le.close()}catch{}Le=null}qt(!1,"Disconnected"),Sl(!1),Wt(`
# Disconnected.
`)});async function ro(t){if(Le&&t.trim()){Ss.disabled=!0,Wt(`
$ ${t}
`);try{const e=Le.subprocess.shellProtocol;let r,n;if(e&&e.isSupported){const o=await e.spawn(t);r=o.stdout,n=o.exited}else r=(await Le.subprocess.noneProtocol.spawn(t)).output;const i=new TextDecoder,s=r.getReader();try{for(;;){const{done:o,value:a}=await s.read();if(o)break;Wt(i.decode(a,{stream:!0}))}}finally{s.releaseLock()}if(n){const o=await n;o!==0&&Wt(`
[exit ${o}]
`)}}catch(e){const r=e instanceof Error?e.message:String(e);Wt(`
[error: ${r}]
`),vl(r)}finally{Ss.disabled=!1,Rr.focus()}}}Ss.addEventListener("click",()=>ro(Rr.value));Rr.addEventListener("keydown",t=>{t.key==="Enter"&&ro(Rr.value)});Od.addEventListener("click",()=>{Fn.textContent=""});jd.forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.cmd??"";Rr.value=e,ro(e)})});async function jo(t,e){try{const r=t.subprocess.shellProtocol;let n;r&&r.isSupported?n=(await r.spawn(`getprop ${e}`)).stdout:n=(await t.subprocess.noneProtocol.spawn(`getprop ${e}`)).output;const i={stdout:n},s=[],o=i.stdout.getReader();try{for(;;){const{done:c,value:u}=await o.read();if(c)break;s.push(u)}}finally{o.releaseLock()}return new TextDecoder().decode(s.reduce((c,u)=>{const h=new Uint8Array(c.length+u.length);return h.set(c),h.set(u,c.length),h},new Uint8Array)).trim()||null}catch{return null}}function Hi(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}
