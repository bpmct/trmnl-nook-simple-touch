import { escapeArg } from "./subprocess/index.js";
/**
 * Install an apk file to the device.
 * @param adb An Adb instance
 * @returns A writable stream that accepts an APK file
 * @deprecated Use `PackageManager#installStream` from `@yume-chan/android-bin` package instead.
 */
export async function install(adb, file) {
    const fileName = Math.random().toString().substring(2);
    const filePath = `/data/local/tmp/${fileName}.apk`;
    const sync = await adb.sync();
    try {
        await sync.write(filePath, file, undefined, undefined);
    }
    finally {
        await sync.dispose();
    }
    try {
        await adb.subprocess.spawnAndWaitLegacy([
            "pm",
            "install",
            escapeArg(filePath),
        ]);
    }
    finally {
        await adb.rm(filePath);
    }
}
//# sourceMappingURL=install.js.map